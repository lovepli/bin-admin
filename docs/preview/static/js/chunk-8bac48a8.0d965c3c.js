(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8bac48a8"],{"024d":function(e){e.exports=JSON.parse('[{"fieldName":"name","fieldTitle":"姓名","dataType":"string","dataLength":64,"controlType":"text","status":"manage"},{"fieldName":"id_type","fieldTitle":"证件类型","dataType":"string","dataLength":3,"controlType":"select","status":"manage"},{"fieldName":"id_code","fieldTitle":"证件号码","dataType":"string","dataLength":64,"controlType":"text","status":"manage"},{"id":"c0a86e8f709d1b6281709f2bf72f000e","metadataId":"c0a86e8f709d1b6281709f2bf71d000d","fieldName":"test","fieldTitle":"是否启用","dataType":"text","fieldSort":"0"}]')},"27ae":function(module,exports,__webpack_require__){(function(global){var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;(function(e,t){module.exports=t(e)})("undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof global?global:this,(function(global){"use strict";global=global||{};var _Base64=global.Base64,version="2.5.2",buffer;if(module.exports)try{buffer=eval("require('buffer').Buffer")}catch(err){buffer=void 0}var b64chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",b64tab=function(e){for(var t={},a=0,n=e.length;a<n;a++)t[e.charAt(a)]=a;return t}(b64chars),fromCharCode=String.fromCharCode,cb_utob=function(e){if(e.length<2){var t=e.charCodeAt(0);return t<128?e:t<2048?fromCharCode(192|t>>>6)+fromCharCode(128|63&t):fromCharCode(224|t>>>12&15)+fromCharCode(128|t>>>6&63)+fromCharCode(128|63&t)}t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320);return fromCharCode(240|t>>>18&7)+fromCharCode(128|t>>>12&63)+fromCharCode(128|t>>>6&63)+fromCharCode(128|63&t)},re_utob=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,utob=function(e){return e.replace(re_utob,cb_utob)},cb_encode=function(e){var t=[0,2,1][e.length%3],a=e.charCodeAt(0)<<16|(e.length>1?e.charCodeAt(1):0)<<8|(e.length>2?e.charCodeAt(2):0),n=[b64chars.charAt(a>>>18),b64chars.charAt(a>>>12&63),t>=2?"=":b64chars.charAt(a>>>6&63),t>=1?"=":b64chars.charAt(63&a)];return n.join("")},btoa=global.btoa?function(e){return global.btoa(e)}:function(e){return e.replace(/[\s\S]{1,3}/g,cb_encode)},_encode=function(e){var t="[object Uint8Array]"===Object.prototype.toString.call(e);return t?e.toString("base64"):btoa(utob(String(e)))},encode=function(e,t){return t?_encode(String(e)).replace(/[+\/]/g,(function(e){return"+"==e?"-":"_"})).replace(/=/g,""):_encode(e)},encodeURI=function(e){return encode(e,!0)},re_btou=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,cb_btou=function(e){switch(e.length){case 4:var t=(7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3),a=t-65536;return fromCharCode(55296+(a>>>10))+fromCharCode(56320+(1023&a));case 3:return fromCharCode((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return fromCharCode((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},btou=function(e){return e.replace(re_btou,cb_btou)},cb_decode=function(e){var t=e.length,a=t%4,n=(t>0?b64tab[e.charAt(0)]<<18:0)|(t>1?b64tab[e.charAt(1)]<<12:0)|(t>2?b64tab[e.charAt(2)]<<6:0)|(t>3?b64tab[e.charAt(3)]:0),r=[fromCharCode(n>>>16),fromCharCode(n>>>8&255),fromCharCode(255&n)];return r.length-=[0,0,2,1][a],r.join("")},_atob=global.atob?function(e){return global.atob(e)}:function(e){return e.replace(/\S{1,4}/g,cb_decode)},atob=function(e){return _atob(String(e).replace(/[^A-Za-z0-9\+\/]/g,""))},_decode=buffer?buffer.from&&Uint8Array&&buffer.from!==Uint8Array.from?function(e){return(e.constructor===buffer.constructor?e:buffer.from(e,"base64")).toString()}:function(e){return(e.constructor===buffer.constructor?e:new buffer(e,"base64")).toString()}:function(e){return btou(_atob(e))},decode=function(e){return _decode(String(e).replace(/[-_]/g,(function(e){return"-"==e?"+":"/"})).replace(/[^A-Za-z0-9\+\/]/g,""))},noConflict=function(){var e=global.Base64;return global.Base64=_Base64,e};if(global.Base64={VERSION:version,atob:atob,btoa:btoa,fromBase64:decode,toBase64:encode,utob:utob,encode:encode,encodeURI:encodeURI,btou:btou,decode:decode,noConflict:noConflict,__buffer__:buffer},"function"===typeof Object.defineProperty){var noEnum=function(e){return{value:e,enumerable:!1,writable:!0,configurable:!0}};global.Base64.extendString=function(){Object.defineProperty(String.prototype,"fromBase64",noEnum((function(){return decode(this)}))),Object.defineProperty(String.prototype,"toBase64",noEnum((function(e){return encode(this,e)}))),Object.defineProperty(String.prototype,"toBase64URI",noEnum((function(){return encode(this,!0)})))}}return global["Meteor"]&&(Base64=global.Base64),module.exports?module.exports.Base64=global.Base64:(__WEBPACK_AMD_DEFINE_ARRAY__=[],__WEBPACK_AMD_DEFINE_RESULT__=function(){return global.Base64}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),void 0===__WEBPACK_AMD_DEFINE_RESULT__||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)),{Base64:global.Base64}}))}).call(this,__webpack_require__("c8ba"))},"344a":function(e,t,a){"use strict";function n(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?n(a,!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):n(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}t["a"]={data:function(){return{moduleName:"",currentTreeNode:null,filterOpened:!1,listQuery:{size:10,page:1},total:0,list:[],listLoading:!1,btnLoading:!1,dialogStatus:""}},computed:{editTitle:function(){var e={check:this.moduleName+"详情",modify:"修改"+this.moduleName,create:"新增"+this.moduleName};return e[this.dialogStatus]||"标题"},isNormal:function(){return 0===this.dialogStatus.length},isCheck:function(){return"check"===this.dialogStatus},isEdit:function(){return"create"===this.dialogStatus||"modify"===this.dialogStatus},lockTreeSelect:function(){return"check"===this.dialogStatus||"modify"===this.dialogStatus},colorPrimary:function(){return{color:"#1890ff"}},colorSuccess:function(){return{color:"#52c41a"}},colorWarning:function(){return{color:"#fa8c16"}},colorDanger:function(){return{color:"#f5222d"}},colorInfo:function(){return{color:"#35495e"}}},watch:{dialogStatus:function(){window.scrollTo(0,0)}},methods:{treeMapper:function(e,t){var a=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"text",s=e.id,o=t?t.split(","):[];o.push(s);var l=[];e.children&&e.children.forEach((function(e){l.push(a.treeMapper(e,o.join(","),n,i))}));var c=!!this.currentTreeNode&&this.currentTreeNode.id===s,u=!!this.currentTreeNode&&this.currentTreeNode.parents.includes(s),d={};return n.forEach((function(t){e[t]&&(d[t]=e[t])})),r({id:e.id,title:e[i]},d,{parents:o,selected:c,expand:u,children:l})},formatOptions:function(e){var t=[];return Object.keys(e).forEach((function(a){t.push({value:a,label:e[a]})})),t},setListData:function(e){e?(this.list=e.list,this.total=e.total,this.listLoading=!1):this.listLoading=!0},openEditPage:function(e){this.dialogStatus=e,this.$refs.form&&this.$refs.form.resetFields()},handleCancel:function(){this.dialogStatus=""},submitDone:function(e){this.dialogStatus="",this.btnLoading=!1,e&&this.$message({type:"success",content:"操作成功"})},searchList:function(){console.error("searchList need overwrite (from mixin)")},handleFilter:function(){this.listQuery.page=1,this.searchList()},handleSizeChange:function(e){this.listQuery.page=1,this.listQuery.size=e,this.searchList()},handleCurrentChange:function(e){this.listQuery.page=e,this.searchList()}}}},3925:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("page-header-wrap",[a("v-table-wrap",[a("v-title-bar",{staticClass:"mb-20",attrs:{label:"信息项配置"}},[a("div",[a("b-button",{attrs:{type:"text"},on:{click:e.openJsonModal}},[a("b-icon",{attrs:{name:"ios-cloud-upload"}}),e._v(" 导入json\n          ")],1),a("b-button",{attrs:{type:"text"},on:{click:e.loadFields}},[a("b-icon",{attrs:{name:"ios-cloud-download"}}),e._v(" 导入默认\n          ")],1),a("b-button",{attrs:{type:"text"},on:{click:function(t){e.fields=[]}}},[a("b-icon",{attrs:{name:"ios-trash"}}),e._v(" 清空\n          ")],1),a("b-button",{attrs:{type:"text"},on:{click:e.previewForm}},[a("b-icon",{attrs:{name:"ios-eye"}}),e._v(" 预览\n          ")],1),e._v("  \n          Debug：\n          "),a("b-switch",{attrs:{size:"small"},model:{value:e.debugJson,callback:function(t){e.debugJson=t},expression:"debugJson"}})],1)]),a("fields-cfg",{model:{value:e.fields,callback:function(t){e.fields=t},expression:"fields"}}),a("div",{directives:[{name:"show",rawName:"v-show",value:e.debugJson,expression:"debugJson"}],staticClass:"mt-15"},[a("b-tag",{attrs:{type:"success",size:"small"}},[e._v("实际存储对象[fields]")]),a("b-ace-editor",{attrs:{value:JSON.stringify(e.fields,null,2),readonly:"",wrap:""}})],1)],1)],1),a("b-modal",{attrs:{title:"导入Json","z-index":50,width:"750px"},on:{"on-ok":e.importJson},model:{value:e.jsonModal,callback:function(t){e.jsonModal=t},expression:"jsonModal"}},[a("b-ace-editor",{attrs:{wrap:""},model:{value:e.jsonStr,callback:function(t){e.jsonStr=t},expression:"jsonStr"}})],1),a("b-modal",{attrs:{title:"预览表单",width:"1200px",styles:{top:"20px"}},on:{"on-hidden":function(t){e.previewModalForm=!1}},model:{value:e.previewModal,callback:function(t){e.previewModal=t},expression:"previewModal"}},[e.previewModalForm?a("b-form",{ref:"dynamicFormRef",attrs:{model:e.form,rules:e.rules,"label-position":"top"}},e._l(e.dynamicForm,(function(t,n){return a("form-item",{key:t.id||n,attrs:{label:t.fieldTitle,prop:t.fieldName,"control-type":t.controlType}},[a("form-control",{attrs:{"resource-key":"test-resource-key","table-name":"test-table-name","control-type":t.controlType,"field-name":t.fieldName,"field-desc":t.fieldDesc,"field-title":t.fieldTitle,"data-length":t.dataLength,"data-precision":t.dataPrecision,options:t.validOptions},on:{"on-select":e.handleSelectNatLeg},model:{value:e.form[t.fieldName],callback:function(a){e.$set(e.form,t.fieldName,a)},expression:"form[item.fieldName]"}})],1)})),1):e._e(),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("b-button",{attrs:{type:"primary"},on:{click:e.handleDynamicFormSubmit}},[e._v("提 交")]),a("b-button",{on:{click:e.handleDynamicFormReset}},[e._v("重 置")])],1)],1)],1)},r=[],i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"config-panel",style:{maxHeight:e.maxHeight+2+"px"}},[a("div",{staticClass:"left-fields"},[a("v-title-bar",{attrs:{label:"信息项","tip-pos":"left"}},[a("b-tooltip",{attrs:{"max-width":"200",content:"点击选中信息项进行配置，也可以拖动元素排序"}},[a("b-icon",{staticClass:"pl-10 pr-10",attrs:{name:"ios-help-circle"}})],1)],1),a("v-drag-items",{ref:"dragItems",attrs:{"no-data-text":"暂无信息项"},on:{"on-drop":e.handleDrag,"on-select":e.handleSelect},model:{value:e.totalData,callback:function(t){e.totalData=t},expression:"totalData"}})],1),a("div",{staticClass:"right-panel"},[a("v-title-bar",{attrs:{label:"配置项","tip-pos":"left"}}),e.currentIndex>-1?a("div",{ref:"rightPanel",staticClass:"config-item"},[a("b-form",{ref:"cfgForm",attrs:{"label-position":"top"},model:{value:e.totalData[e.currentIndex],callback:function(t){e.$set(e.totalData,e.currentIndex,t)},expression:"totalData[currentIndex]"}},[a("b-row",{attrs:{gutter:15}},[a("b-col",{attrs:{span:"8"}},[a("b-form-item",{staticClass:"bin-form-item-required",class:{"bin-form-item-error":0===e.totalData[e.currentIndex].fieldTitle.length},attrs:{label:"标题"}},[a("b-input",{on:{"on-change":e.emitValue},model:{value:e.totalData[e.currentIndex].fieldTitle,callback:function(t){e.$set(e.totalData[e.currentIndex],"fieldTitle","string"===typeof t?t.trim():t)},expression:"totalData[currentIndex].fieldTitle"}}),0===e.totalData[e.currentIndex].fieldTitle.length?a("span",{staticClass:"bin-form-item-error-tip"},[e._v("标题不能为空")]):e._e()],1)],1),a("b-col",{attrs:{span:"8"}},[a("b-form-item",{staticClass:"bin-form-item-required",attrs:{label:"公开类型"}},[a("b-select",{on:{"on-change":e.emitValue},model:{value:e.totalData[e.currentIndex].openType,callback:function(t){e.$set(e.totalData[e.currentIndex],"openType",t)},expression:"totalData[currentIndex].openType"}},e._l(e.enumMap.openType,(function(t,n){return a("b-option",{key:n,attrs:{value:n}},[e._v(e._s(t))])})),1)],1)],1),a("b-col",{attrs:{span:"8"}},[a("b-form-item",{staticClass:"bin-form-item-required",attrs:{label:"数据类型"}},[a("b-input",{attrs:{value:e.enumMap.dataType[e.totalData[e.currentIndex].dataType],disabled:""}})],1)],1)],1),a("b-divider"),a("valid-value",{attrs:{"show-valid-value":e.showValidValue},on:{"on-change":e.emitValue},model:{value:e.totalData[e.currentIndex].validValue,callback:function(t){e.$set(e.totalData[e.currentIndex],"validValue",t)},expression:"totalData[currentIndex].validValue"}},[a("b-form-item",{staticClass:"bin-form-item-required",attrs:{label:"控件类型"}},[a("b-select",{on:{"on-change":e.controlTypeChange},model:{value:e.totalData[e.currentIndex].controlType,callback:function(t){e.$set(e.totalData[e.currentIndex],"controlType",t)},expression:"totalData[currentIndex].controlType"}},e._l(e.controlTypeFilter,(function(t,n){return a("b-option",{key:n,attrs:{value:n}},[e._v(e._s(t))])})),1)],1)],1),a("b-divider"),a("validator",{attrs:{"field-name":e.totalData[e.currentIndex].fieldName,"field-title":e.totalData[e.currentIndex].fieldTitle,"control-type":e.totalData[e.currentIndex].controlType,"data-type":e.totalData[e.currentIndex].dataType,required:e.totalData[e.currentIndex].required,"data-length":e.totalData[e.currentIndex].dataLength,"original-rules":e.originalRules},on:{"on-change":e.emitValue},model:{value:e.totalData[e.currentIndex].checkRules,callback:function(t){e.$set(e.totalData[e.currentIndex],"checkRules",t)},expression:"totalData[currentIndex].checkRules"}},[a("b-form-item",{staticClass:"bin-form-item-required",attrs:{label:"信息项类型"}},[a("b-radio-group",{on:{"on-change":e.emitValue},model:{value:e.totalData[e.currentIndex].required,callback:function(t){e.$set(e.totalData[e.currentIndex],"required",t)},expression:"totalData[currentIndex].required"}},e._l(e.enumMap.required,(function(t,n){return a("b-radio",{key:n,attrs:{label:n}},[e._v(e._s(t))])})),1)],1)],1),a("b-divider"),a("b-form-item",{attrs:{label:"启用状态"}},[a("div",{staticStyle:{"padding-top":"3px"}},[a("b-switch",{attrs:{"true-value":"use","false-value":"ignore"},on:{"on-change":e.emitValue},model:{value:e.totalData[e.currentIndex].status,callback:function(t){e.$set(e.totalData[e.currentIndex],"status",t)},expression:"totalData[currentIndex].status"}}),e._v("  \n            "),a("b-tag",{attrs:{type:"use"===e.totalData[e.currentIndex].status?"primary":"danger","no-border":"","font-size":"14px"}},[e._v("\n              "+e._s(e.enumMap.status[e.totalData[e.currentIndex].status])+"\n            ")])],1)]),a("b-row",{attrs:{gutter:15}},[a("b-col",{attrs:{span:"6"}},[a("b-form-item",{attrs:{label:"是否分词"}},[a("b-select",{attrs:{clearable:"",disabled:e.tokenizerDisabled},on:{"on-change":e.emitValue},model:{value:e.totalData[e.currentIndex].tokenizer,callback:function(t){e.$set(e.totalData[e.currentIndex],"tokenizer",t)},expression:"totalData[currentIndex].tokenizer"}},e._l(e.enumMap.tokenizer,(function(t,n){return a("b-option",{key:n,attrs:{value:n}},[e._v(e._s(t))])})),1)],1)],1),a("b-col",{attrs:{span:"6"}},[e.totalData[e.currentIndex].dataLength?a("b-form-item",{attrs:{label:"字段长度"}},[a("b-input",{attrs:{value:e.totalData[e.currentIndex].dataLength,readonly:""}})],1):e._e()],1),a("b-col",{attrs:{span:"6"}},[a("b-form-item",{attrs:{label:"是否加密"}},[a("b-select",{attrs:{placeholder:"",clearable:""},on:{"on-change":e.emitValue},model:{value:e.totalData[e.currentIndex].isEncrypt,callback:function(t){e.$set(e.totalData[e.currentIndex],"isEncrypt",t)},expression:"totalData[currentIndex].isEncrypt"}},e._l(e.enumMap.isEncrypt,(function(t,n){return a("b-option",{key:n,attrs:{value:n}},[e._v(e._s(t))])})),1)],1)],1),a("b-col",{attrs:{span:"6"}},[a("b-form-item",{attrs:{label:"掩码方式"}},[a("b-select",{attrs:{clearable:""},on:{"on-change":e.emitValue},model:{value:e.totalData[e.currentIndex].maskModel,callback:function(t){e.$set(e.totalData[e.currentIndex],"maskModel",t)},expression:"totalData[currentIndex].maskModel"}},e._l(e.enumMap.maskModel,(function(t,n){return a("b-option",{key:n,attrs:{value:n}},[e._v(e._s(t))])})),1)],1)],1)],1),a("b-form-item",{attrs:{label:"信息项描述"}},[a("b-input",{attrs:{rows:1,placeholder:"输入信息项描述",type:"textarea"},on:{"on-change":e.emitValue},model:{value:e.totalData[e.currentIndex].fieldDesc,callback:function(t){e.$set(e.totalData[e.currentIndex],"fieldDesc","string"===typeof t?t.trim():t)},expression:"totalData[currentIndex].fieldDesc"}})],1)],1)],1):a("b-empty",[e._v("没有选择信息项")])],1)])},s=[],o=a("6191"),l=a("212a"),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"item-wrap"},[a("draggable",e._b({on:{end:e.onDragEnd},model:{value:e.totalData,callback:function(t){e.totalData=t},expression:"totalData"}},"draggable",{group:"item",animation:200,ghostClass:"item-over",handle:".item-drag"},!1),e._l(e.totalData,(function(t,n){return a("div",{key:n,staticClass:"item",class:[{ignore:"ignore"===t.status},{"is-textarea":["FILE_UPLOAD","TEXTAREA"].indexOf(t.controlType)>-1}]},[a("div",{staticClass:"item-inner",class:[{"item-selected":e.currentIndex===n},{"empty-title":0===t.fieldTitle.length}],attrs:{title:t.fieldTitle},on:{click:function(t){return e.handleSelect(n)}}},[a("div",{staticClass:"item-field"},[a("div",{staticClass:"item-drag"},[a("b-icon",{attrs:{name:"ios-move"}})],1),a("span",{attrs:{draggable:"true"},on:{dragstart:function(a){return e.onDrag(a,t.fieldName)}}},[e._v(e._s(t.fieldName))])]),t.fieldTitle.length>0?a("div",{staticClass:"item-name"},[e._v(e._s(t.fieldTitle))]):a("div",{staticClass:"item-name"},[a("b-tag",{attrs:{type:"danger",size:"mini"}},[e._v("空标题")])],1),a("span",{staticClass:"item-required",class:{active:"Y"===t.required}},[e._v("核心")]),a("span",{staticClass:"item-required rule",class:{active:e.hasRequiredRule(t)}},[e._v("必填")])])])})),0),0===e.totalData.length?a("b-empty",[e._v(e._s(e.noDataText))]):e._e()],1)},u=[],d=a("310e"),p=a.n(d),m=a("ad03"),h={name:"VDragItems",components:{Draggable:p.a},props:{value:{type:Array,default:function(){return[]}},noDataText:{type:String,default:"暂无数据"},isFull:{type:Boolean},selectCancel:{type:Boolean}},data:function(){return{totalData:[],currentIndex:-1}},watch:{value:{handler:function(e){this.totalData=Object(l["a"])(e),this.totalData.length>0&&-1===this.currentIndex&&(this.currentIndex=0)},immediate:!0}},methods:{onDrag:function(e,t){e.dataTransfer.setData("index",t)},onDrop:function(e,t){var a=e.dataTransfer.getData("index");parseInt(a)!==t&&this.$emit("on-drag-drop",a,t),Object(m["c"])(e.target,"item-over"),e.preventDefault()},onEnter:function(e){Object(m["a"])(e.target,"item-over"),e.preventDefault()},onLeave:function(e){Object(m["c"])(e.target,"item-over"),e.preventDefault()},allowDrop:function(e){e.preventDefault()},hasRequiredRule:function(e){return e.checkRules.indexOf("$required")>-1},handleSelect:function(e){this.currentIndex!==e?(this.currentIndex=e,this.$emit("on-select",this.currentIndex)):this.selectCancel&&(this.currentIndex=-1,this.$emit("on-select",this.currentIndex))},clearSelect:function(){this.currentIndex=-1},onDragEnd:function(e){var t=e.oldIndex,a=e.newIndex;t!==a&&(this.currentIndex=-1,this.$emit("input",this.totalData),this.$emit("on-drop"))}}},f=h,g=(a("ea4a"),a("2877")),b=Object(g["a"])(f,c,u,!1,null,"05d2b598",null),v=b.exports,y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"valid-value-wrap"},[a("div",{staticClass:"mb-10"},[a("b-row",{attrs:{gutter:15}},[e.$slots.default?a("b-col",{attrs:{span:"8"}},[e._t("default")],2):e._e(),e.showValidValue?a("b-col",{attrs:{span:e.$slots.default?16:24}},[a("div",{staticStyle:{width:"100%","line-height":"32px"},attrs:{flex:"main:justify"}},[a("span",[e._v("有效值: ")]),a("div",[a("b-tooltip",{attrs:{content:"清空有效值"}},[a("b-icon",{staticStyle:{"vertical-align":"-1px",cursor:"pointer"},attrs:{name:"ios-trash"},nativeOn:{click:function(t){return e.emitEmptyValue(t)}}})],1),a("v-toggle-show",{attrs:{"show-text":"显示调试","hide-text":"隐藏调试"},model:{value:e.showReal,callback:function(t){e.showReal=t},expression:"showReal"}})],1)]),a("div",{staticStyle:{width:"100%","line-height":"32px"},attrs:{flex:"cross:center"}},[a("b-radio-group",{model:{value:e.normalType,callback:function(t){e.normalType=t},expression:"normalType"}},[a("b-radio",{attrs:{label:"enum"}},[a("span",[e._v("枚举")])]),a("b-radio",{attrs:{label:"dict"}},[a("span",[e._v("字典")])])],1),e.isDict?a("b-button",{attrs:{icon:"ios-apps",size:"mini",type:"primary",transparent:""},on:{click:e.openDictModal}},[e._v("\n            选择字典\n          ")]):e._e()],1)]):e._e()],1)],1),e.showValidValue?a("div",[a("div",{directives:[{name:"show",rawName:"v-show",value:e.isDict,expression:"isDict"}]},[a("span",[a("b-tag",{staticStyle:{margin:"0"},attrs:{type:"primary"}},[e._v("字典名称")]),a("b-tag",{staticStyle:{margin:"0 5px 0 0"}},[e._v(e._s(e.dict.name))]),a("b-tag",{staticStyle:{margin:"0"},attrs:{type:"primary"}},[e._v("字典编码")]),a("b-tag",{staticStyle:{margin:"0"}},[e._v(e._s(e.dict.code))])],1),e._v("\n       \n      "),e.dict.code.length>0?a("b-button",{attrs:{type:"text"},on:{click:function(t){return e.getDictItemList(e.dict.code)}}},[e._v("详情")]):e._e()],1),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isEnum,expression:"isEnum"}]},[a("draggable",e._b({on:{end:e.onDragEnd},model:{value:e.arrData,callback:function(t){e.arrData=t},expression:"arrData"}},"draggable",{group:"enum",animation:200,ghostClass:"ghost",handle:".move-drag"},!1),[a("transition-group",{staticClass:"enum-list",attrs:{name:"fade",tag:"div"}},e._l(e.arrData,(function(t,n){return a("div",{key:t.id||n,staticClass:"enum-item"},[a("span",{staticClass:"move-drag"},[a("b-icon",{attrs:{name:"ios-menu",size:"20"}})],1),a("b-input",{staticStyle:{width:"40%"},attrs:{placeholder:"code"},on:{"on-change":e.emitValue},model:{value:e.arrData[n].code,callback:function(t){e.$set(e.arrData[n],"code","string"===typeof t?t.trim():t)},expression:"arrData[index].code"}}),e._v(" \n            "),a("b-input",{staticStyle:{width:"40%"},attrs:{placeholder:"name"},on:{"on-change":e.emitValue},model:{value:e.arrData[n].name,callback:function(t){e.$set(e.arrData[n],"name","string"===typeof t?t.trim():t)},expression:"arrData[index].name"}}),e._v(" \n            "),a("b-button",{attrs:{type:"text","text-color":"#f5222d"},on:{click:function(t){return e.removeEnumItem(n)}}},[a("b-icon",{attrs:{name:"ios-remove-circle-outline",size:"22"}})],1)],1)})),0)],1),a("b-button",{staticStyle:{width:"100%"},attrs:{type:"primary",dashed:"",plain:"",icon:"ios-add-circle-outline"},on:{click:e.addNewEnum}},[e._v("\n        添加项\n      ")])],1),e.showReal?a("div",{staticClass:"pt-10",attrs:{flex:"box:first"}},[a("b-tag",{attrs:{type:"success","tag-style":{margin:0}}},[e._v("实际存储值")]),a("b-input",{attrs:{value:e.validValue,placeholder:"检查配置正确值使用",readonly:""}})],1):e._e()]):e._e(),a("b-modal",{staticClass:"layout-inner",attrs:{title:"选择系统字典",width:"860","mask-closable":!1},model:{value:e.chooseModal,callback:function(t){e.chooseModal=t},expression:"chooseModal"}},[a("div",[a("v-filter-bar",{on:{"keyup-enter":e.handleFilter}},[a("v-filter-item",{attrs:{title:"字典名称"}},[a("b-input",{attrs:{placeholder:"请输入",clearable:""},model:{value:e.listQuery.groupName,callback:function(t){e.$set(e.listQuery,"groupName","string"===typeof t?t.trim():t)},expression:"listQuery.groupName"}})],1),a("v-filter-item",{attrs:{title:"字典编码",width:"230px"}},[a("b-input",{attrs:{placeholder:"请输入",clearable:""},model:{value:e.listQuery.groupCode,callback:function(t){e.$set(e.listQuery,"groupCode","string"===typeof t?t.trim():t)},expression:"listQuery.groupCode"}})],1),a("v-filter-item",{on:{"on-search":e.handleFilter,"on-reset":e.resetQuery}})],1),a("b-table",{attrs:{columns:e.columns,data:e.list,loading:e.listLoading,size:"small"},scopedSlots:e._u([{key:"action",fn:function(t){return[a("b-button",{attrs:{type:"text"},on:{click:function(a){return e.chooseOne(t.row)}}},[e._v("选择")])]}}])})],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("b-page",{attrs:{total:e.total,current:e.listQuery.page},on:{"update:current":function(t){return e.$set(e.listQuery,"page",t)},"on-change":e.handleCurrentChange}})],1)]),a("b-modal",{attrs:{title:"字典详情"},model:{value:e.dictModal,callback:function(t){e.dictModal=t},expression:"dictModal"}},[a("b-table",{attrs:{columns:e.dictColumns,data:e.dictItems,size:"small"}}),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("b-button",{on:{click:function(t){e.dictModal=!1}}},[e._v("返 回")])],1)],1)],1)},x=[],k=a("a34a"),_=a.n(k);function C(e){var t=/^(([1-3][0-9]{3})[-]{0,1}(((0[13578]|1[02])[-]{0,1}(0[1-9]|[12][0-9]|3[01]))|((0[469]|11)[-]{0,1}(0[1-9]|[12][0-9]|30))|(02-(0[1-9]|[1][0-9]|2[0-8])))\s\d{1,2}:\d{1,2}:\d{1,2})|(([1-3][0-9]{3})[-]{0,1}(((0[13578]|1[02])[-]{0,1}(0[1-9]|[12][0-9]|3[01]))|((0[469]|11)-(0[1-9]|[12][0-9]|30))|(02-(0[1-9]|[1][0-9]|2[0-8])))\s\d{1,2}:\d{1,2})|(([1-3][0-9]{3})[-]{0,1}(((0[13578]|1[02])[-]{0,1}(0[1-9]|[12][0-9]|3[01]))|((0[469]|11)[-]{0,1}(0[1-9]|[12][0-9]|30))|(02-(0[1-9]|[1][0-9]|2[0-8]))))$/;return t.test(e)}function R(e){var t={11:"北京",12:"天津",13:"河北",14:"山西",15:"内蒙古",21:"辽宁",22:"吉林",23:"黑龙江",31:"上海",32:"江苏",33:"浙江",34:"安徽",35:"福建",36:"江西",37:"山东",41:"河南",42:"湖北",43:"湖南",44:"广东",45:"广西",46:"海南",50:"重庆",51:"四川",52:"贵州",53:"云南",54:"西藏",61:"河南",62:"甘肃",63:"青海",64:"宁夏",65:"新疆",71:"台湾",81:"香港",82:"澳门",91:"国外"};if(!/(^\d{15}$)|(^\d{17}([0-9]|X)$)/.test(e))return!1;if(e=e.replace(/x$/i,"a"),null==t[parseInt(e.substr(0,2))])return!1;var a=e.substr(6,4)+"-"+Number(e.substr(10,2))+"-"+Number(e.substr(12,2)),n=new Date(a.replace(/-/g,"/"));if(a!==n.getFullYear()+"-"+(n.getMonth()+1)+"-"+n.getDate())return!1;for(var r=0,i=17;i>=0;i--)r+=Math.pow(2,i)%11*parseInt(e.charAt(17-i),11);return r%11===1}function w(e){if(!/^[0-9ABCDEFGHJKLMNPQRTUWXY]{18}$/.test(e))return!1;for(var t="0123456789ABCDEFGHJKLMNPQRTUWXY",a=[1,3,9,27,19,26,16,17,20,29,25,13,8,24,10,30,28],n=0,r=0;r<17;r++){var i=t.indexOf(e[r]);if(i<0)return!1;n+=i*a[r]}n%=31;var s=t[(31-n)%31];return s===e[17]}function D(e){e=String(e);for(var t,a=10,n=0;n<15;n++)t=a%11+parseInt(e[n]),a=t%10*2,0===a&&(a=20);return t%10===1}function T(e){var t=/^[0-9]{15}$/;return t.test(e)&&D(e)}function E(e){var t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",a=/^[0-9A-Z]{8}-?[0-9X]$/,n=[3,7,9,10,5,8,4,2],r="0123456789X0";function i(e){e=String(e);for(var a,i=e.replace("-",""),s=0,o=0;o<8;o++)a=t.indexOf(i[o]),s+=a*n[o];return s%=11,r[11-s]===i[8]}return a.test(e)&&i(e)}var O=a("0c6d");function S(e){return Object(O["b"])({url:"/api/dict/queryItems",method:"get",params:{groupCode:e}})}function A(e){return Object(O["b"])({url:"/api/dir/gather/queryByPagingWithLegBaseInfo",method:"get",params:{size:e.size,page:e.page-1,compName:e.compName}})}function $(e){return Object(O["b"])({url:"/api/dir/gather/queryByPagingWithNatBaseInfo",method:"get",params:{size:e.size,page:e.page-1,name:e.name}})}function N(e,t,a,n,r,i,s){try{var o=e[i](s),l=o.value}catch(c){return void a(c)}o.done?t(l):Promise.resolve(l).then(n,r)}function I(e){return function(){var t=this,a=arguments;return new Promise((function(n,r){var i=e.apply(t,a);function s(e){N(i,n,r,s,o,"next",e)}function o(e){N(i,n,r,s,o,"throw",e)}s(void 0)}))}}var L={required:"$required",length:"$length",email:"$email",phone:"$phone",regexp:"$regexp",idCode:"$idCode",unifiedCode:"$unifiedCode",orgInstCode:"$orgInstCode",regNo:"$regNo",conditionRequired:"$conditionRequired",conditionNotRequired:"$conditionNotRequired",conditionNotBe:"$conditionNotBe",notSame:"$notSame",timeBound:"$timeBound"},F={$required:"必填项",$length:"长度参数",$email:"邮箱参数",$phone:"手机号码",$regexp:"正则匹配",$idCode:"身份证",$unifiedCode:"统一社会信用代码",$orgInstCode:"组织机构代码",$regNo:"工商注册号",$conditionRequired:"条件必填",$conditionNotRequired:"条件必不填",$conditionNotBe:"条件不为某值",$notSame:"值不能相同",$timeBound:"日期区间"},V={$required:function(e){return{required:!0,message:e.message,trigger:e.trigger,type:e.type}},$length:function(e){return{min:e.min,max:e.max,message:e.message,trigger:e.trigger,type:e.type}},$email:function(e){return{type:"email",message:e.message,trigger:e.trigger}},$phone:function(e){return{pattern:/^((0\d{2,3}-\d{7,8})|(1[35874]\d{9}))$/,message:e.message,trigger:e.trigger}},$regexp:function(e){return{pattern:new RegExp(e.regexp),message:e.message,trigger:e.trigger}},$idCode:function(e,t){return t?{validator:function(a,n,r){var i=t[e.preField],s=Object(l["c"])(e.preField)&&"N1"!==i,o=e.ignoreCase?String(n).toUpperCase():n,c=Object(l["b"])(n)||s||R(o);c||r(new Error(e.message)),r()},trigger:e.trigger}:null},$unifiedCode:function(e,t){return t?{validator:function(a,n,r){var i=t[e.preField],s=Object(l["c"])(e.preField)&&"L1"!==i,o=e.ignoreCase?String(n).toUpperCase():n,c=Object(l["b"])(n)||"00000000000000000X"===n||s||w(o);c||r(new Error(e.message)),r()},trigger:e.trigger}:null},$regNo:function(e,t){return t?{validator:function(a,n,r){var i=t[e.preField],s=Object(l["c"])(e.preField)&&"L2"!==i,o=e.ignoreCase?String(n).toUpperCase():n,c=Object(l["b"])(n)||s||T(o);c||r(new Error(e.message)),r()},trigger:e.trigger}:null},$orgInstCode:function(e,t){return t?{validator:function(a,n,r){var i=t[e.preField],s=Object(l["c"])(e.preField)&&"L3"!==i,o=e.ignoreCase?String(n).toUpperCase():n,c=Object(l["b"])(n)||s||E(o);c||r(new Error(e.message)),r()},trigger:e.trigger}:null},$conditionRequired:function(e,t){return t?{validator:function(a,n,r){var i=t[e.preField],s=e.preFieldValue;console.log(i,s),(Object(l["b"])(i)&&Object(l["b"])(s)||i===s||i.toString().includes(s))&&Object(l["b"])(n)&&r(new Error(e.message)),r()},trigger:e.trigger}:null},$conditionNotRequired:function(e,t){return t?{validator:function(a,n,r){var i=t[e.preField],s=e.preFieldValue;(Object(l["b"])(i)&&Object(l["b"])(s)||i===s||i.toString().includes(s))&&Object(l["c"])(n)&&r(new Error(e.message)),r()},trigger:e.trigger}:null},$conditionNotBe:function(e,t){return t?{validator:function(a,n,r){var i=t[e.preField],s=e.preFieldValue;(i===s||i&&i.toString().includes(s))&&(n!==e.notValue&&n.toString()!==e.notValue||r(new Error(e.message))),r()},trigger:e.trigger}:null},$notSame:function(e,t){return t?{validator:function(a,n,r){var i=t[e.preField];(i&&i.toString()===n||i===n)&&r(new Error(e.message)),r()},trigger:e.trigger}:null},$timeBound:function(e,t){return t?{validator:function(a,n,r){if(Object(l["b"])(n))r();else{var i;if("$now"===e.time)i=new Date;else if(C(e.time))i=new Date(e.time.replace(/-/g,"/"));else{var s=t[e.time];i=C(s)?new Date(s.replace(/-/g,"/")):null}var o=e.compareMode,c=new Date(n.replace(/-/g,"/")),u=!0;if(i)switch(o){case"gt":u=c>i;break;case"ge":u=c>=i;break;case"lt":u=c<i;break;case"le":u=c<=i;break}u||r(new Error(e.message)),r()}},trigger:e.trigger}:null}};function j(e){if(e&&e.length>0){var t=e.indexOf(";");if(t>-1){for(var a=[],n=e.slice(0,t).split("/"),r=e.slice(t+1).split("/"),i=0;i<r.length;i++)a.push({code:r[i],name:n[i]});return{type:"enum",data:a}}var s=e.split("/");return{type:"dict",code:s[1],name:s[0]}}return{type:"enum",data:[]}}function z(e){return P.apply(this,arguments)}function P(){return P=I(_.a.mark((function e(t){var a,n,r,i;return _.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=Object(l["a"])(t),e.prev=1,n=t.map((function(e){return M(e.validValue)})),e.next=5,Promise.all(n);case 5:for(r=e.sent,i=0;i<t.length;i++)a[i].fieldName=a[i].fieldName.toLowerCase(),a[i]["validOptions"]=r[i];e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](1),console.warn(e.t0);case 12:return e.abrupt("return",a);case 13:case"end":return e.stop()}}),e,null,[[1,9]])}))),P.apply(this,arguments)}function M(e){return q.apply(this,arguments)}function q(){return q=I(_.a.mark((function e(t){var a,n;return _.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=j(t),n=[],"enum"===a.type?n=a.data:a.type,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)}))),q.apply(this,arguments)}function B(e,t){try{var a=JSON.parse(e);return"array"===Object(l["d"])(a)?a.map((function(e){return V[e.name](e,t)})):(console.warn("不是最新校验格式，请按照最新校验进行配置!"),[])}catch(n){console.warn("checkRules 不是标准json"),console.log(e)}}var U=a("344a"),Q=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.toggle?a("span",{staticStyle:{margin:"0 10px",cursor:"pointer"},on:{click:function(t){return e.emitValue(!1)}}},[a("b-tooltip",{attrs:{content:e.hideText}},[a("b-icon",{staticStyle:{"vertical-align":"-2px"},attrs:{name:"ios-eye",color:"#666",size:"20"}})],1)],1):a("span",{staticStyle:{margin:"0 10px",cursor:"pointer"},on:{click:function(t){return e.emitValue(!0)}}},[a("b-tooltip",{attrs:{content:e.showText}},[a("b-icon",{staticStyle:{"vertical-align":"-2px"},attrs:{name:"ios-eye-off",color:"#666",size:"20"}})],1)],1)},X=[],J={name:"VToggleShow",props:{value:{type:Boolean},showText:{type:String,default:"显示"},hideText:{type:String,default:"隐藏"}},data:function(){return{toggle:!1}},watch:{value:{handler:function(e){this.toggle=e},immediate:!0}},methods:{emitValue:function(e){this.toggle=e,this.$emit("input",this.toggle),this.$emit("on-change",this.toggle)}}},Y=J,K=Object(g["a"])(Y,Q,X,!1,null,null,null),G=K.exports,W={name:"ValidValue",mixins:[U["a"]],components:{VToggleShow:G,Draggable:p.a},props:{value:{type:String},showValidValue:{type:Boolean}},data:function(){return{validValue:"",normalType:"enum",dict:{name:"",code:""},arrData:[],showReal:!1,listQuery:{groupName:"",groupCode:""},chooseModal:!1,columns:[{type:"index",width:50,align:"center"},{title:"字典名称",key:"groupName"},{title:"字典编码",key:"groupCode"},{title:"操作",slot:"action",width:90,align:"center"}],dictModal:!1,dictItems:[],dictColumns:[{type:"index",width:50,align:"center"},{title:"字典名称",key:"name"},{title:"字典编码",key:"code"}]}},computed:{isEnum:function(){return"enum"===this.normalType},isDict:function(){return"dict"===this.normalType}},watch:{value:{handler:function(e){this.validValue=e;var t=j(e);this.normalType=t.type,this.isDict?(this.dict.name=t.name,this.dict.code=t.code,this.arrData=[]):(this.arrData=t.data,this.dict.name="",this.dict.code="")},immediate:!0}},methods:{emitValue:function(){var e="";if("enum"===this.normalType){var t=[],a=[];this.arrData.forEach((function(e){t.push(e.code),a.push(e.name)})),e=0===this.arrData.length?"":a.join("/")+";"+t.join("/")}else e=this.dict.name+"/"+this.dict.code;this.$emit("input",e),this.$emit("on-change",e)},emitEmptyValue:function(){this.$emit("input",""),this.$emit("on-change","")},addNewEnum:function(){this.arrData.push({code:"",name:""}),this.emitValue()},removeEnumItem:function(e){this.arrData.splice(e,1),this.emitValue()},onDragEnd:function(e){var t=e.oldIndex,a=e.newIndex;t!==a&&this.emitValue()},openDictModal:function(){this.chooseModal=!0,this.resetQuery()},resetQuery:function(){this.listQuery={page:1,size:10,groupName:"",groupCode:""},this.handleFilter()},chooseOne:function(e){this.dict.name=e.groupName,this.dict.code=e.groupCode,this.emitValue(),this.chooseModal=!1},searchList:function(){this.setListData(),this.setListData({list:[{groupName:"自然人证件类型",groupCode:"natIdType"},{groupName:"性别",groupCode:"sex"}],total:10})},getDictItemList:function(e){var t=this;S(e).then((function(e){"0"===e.data.code&&(t.dictItems=e.data.data,t.dictModal=!0)}))}}},H=W,Z=(a("6409"),Object(g["a"])(H,y,x,!1,null,"62d796ce",null)),ee=Z.exports,te=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"validator-wrap"},[a("div",{staticClass:"mb-10"},[a("b-row",{attrs:{gutter:15}},[e.$slots.default?a("b-col",{attrs:{span:"12"}},[e._t("default")],2):e._e(),a("b-col",{attrs:{span:e.$slots.default?12:24}},[a("div",{staticStyle:{width:"100%","line-height":"32px"},attrs:{flex:"main:justify"}},[a("span",[e._v("校验: ")]),a("div",[a("b-tooltip",{staticStyle:{margin:"0 10px"},attrs:{content:"初始化校验"}},[a("b-button",{attrs:{type:"text",icon:"ios-refresh","text-color":"#666","icon-style":{fontSize:"20px"}},on:{click:e.refreshRule}})],1),a("b-tooltip",{attrs:{content:"恢复修改前校验"}},[a("b-button",{attrs:{type:"text",icon:"ios-git-pull-request","text-color":"#666","icon-style":{fontSize:"20px"}},on:{click:e.reload}})],1),a("v-toggle-show",{attrs:{"show-text":"显示调试","hide-text":"隐藏调试"},model:{value:e.showReal,callback:function(t){e.showReal=t},expression:"showReal"}})],1)]),a("div",{staticStyle:{width:"100%","line-height":"32px"}},[a("b-checkbox",{attrs:{disabled:"Y"===e.required},on:{"on-change":e.requiredChange},model:{value:e.isRequired,callback:function(t){e.isRequired=t},expression:"isRequired"}},[e._v("必填项")]),a("b-divider",{attrs:{type:"vertical"}}),a("b-dropdown",{on:{"on-click":e.setRules}},[a("b-button",{attrs:{type:"text"}},[e._v("\n              静态规则\n              "),a("b-icon",{attrs:{name:"ios-arrow-down"}})],1),a("b-dropdown-menu",{attrs:{slot:"list"},slot:"list"},[a("b-dropdown-item",{attrs:{name:e.RULE.length}},[e._v("长度")]),a("b-dropdown-item",{attrs:{name:e.RULE.email}},[e._v("邮箱")]),a("b-dropdown-item",{attrs:{name:e.RULE.phone}},[e._v("手机号码")]),a("b-dropdown-item",{attrs:{name:e.RULE.regexp}},[e._v("正则匹配")]),a("b-dropdown-item",{attrs:{name:e.RULE.idCode}},[e._v("身份证号")]),a("b-dropdown-item",{attrs:{name:e.RULE.unifiedCode}},[e._v("统一社会信用代码")]),a("b-dropdown-item",{attrs:{name:e.RULE.orgInstCode}},[e._v("组织机构代码")]),a("b-dropdown-item",{attrs:{name:e.RULE.regNo}},[e._v("工商注册号")])],1)],1),a("b-divider",{attrs:{type:"vertical"}}),a("b-dropdown",{on:{"on-click":e.setRules}},[a("b-button",{attrs:{type:"text"}},[e._v("\n              动态规则\n              "),a("b-icon",{attrs:{name:"ios-arrow-down"}})],1),a("b-dropdown-menu",{attrs:{slot:"list"},slot:"list"},[a("b-dropdown-item",{attrs:{name:e.RULE.conditionRequired}},[e._v("条件必填")]),a("b-dropdown-item",{attrs:{name:e.RULE.conditionNotRequired}},[e._v("条件必不填")]),a("b-dropdown-item",{attrs:{name:e.RULE.conditionNotBe}},[e._v("条件不为某值")]),a("b-dropdown-item",{attrs:{name:e.RULE.notSame}},[e._v("值不等于")]),a("b-dropdown-item",{attrs:{name:e.RULE.timeBound}},[e._v("日期区间")])],1)],1)],1)])],1)],1),a("draggable",e._b({on:{end:e.onDragEnd},model:{value:e.checkRulesArr,callback:function(t){e.checkRulesArr=t},expression:"checkRulesArr"}},"draggable",{group:"rules",animation:200,ghostClass:"ghost",handle:".rules-drag"},!1),[a("transition-group",{staticClass:"rules-list",attrs:{name:"fade",tag:"div"}},e._l(e.checkRulesArr,(function(t,n){return a("div",{key:n},[a("div",{staticClass:"params"},[a("div",{staticClass:"title"},[a("span",{staticClass:"param-tip"},[e._v("规则名：")]),a("b-tag",{staticClass:"rules-drag",attrs:{type:e.ruleStyle(t.name),"no-border":"","tag-style":{padding:"3px",margin:"0",width:"100%"}}},[e._v("\n              "+e._s(e.ruleNameMap[t.name])+"\n            ")])],1),t.name===e.RULE.required?[a("div",{staticClass:"info"},[a("span",{staticClass:"param-tip"},[e._v("错误提示：")]),a("b-input",{attrs:{size:"small"},on:{"on-change":e.emitValue},model:{value:e.checkRulesArr[n].message,callback:function(t){e.$set(e.checkRulesArr[n],"message","string"===typeof t?t.trim():t)},expression:"checkRulesArr[index].message"}})],1)]:e._e(),t.name===e.RULE.length?[a("div",{staticClass:"number"},[a("span",{staticClass:"param-tip"},[e._v("最小值：")]),a("b-input-number",{attrs:{size:"small"},on:{"on-change":e.emitValue},model:{value:e.checkRulesArr[n].min,callback:function(t){e.$set(e.checkRulesArr[n],"min",t)},expression:"checkRulesArr[index].min"}})],1),a("div",{staticClass:"number"},[a("span",{staticClass:"param-tip"},[e._v("最大值：")]),a("b-input-number",{attrs:{size:"small"},on:{"on-change":e.emitValue},model:{value:e.checkRulesArr[n].max,callback:function(t){e.$set(e.checkRulesArr[n],"max",t)},expression:"checkRulesArr[index].max"}})],1),a("div",{staticClass:"info"},[a("span",{staticClass:"param-tip"},[e._v("错误提示：")]),a("b-input",{attrs:{size:"small"},on:{"on-change":e.emitValue},model:{value:e.checkRulesArr[n].message,callback:function(t){e.$set(e.checkRulesArr[n],"message","string"===typeof t?t.trim():t)},expression:"checkRulesArr[index].message"}})],1)]:e._e(),t.name===e.RULE.email?[a("div",{staticClass:"info"},[a("span",{staticClass:"param-tip"},[e._v("错误提示：")]),a("b-input",{attrs:{size:"small"},on:{"on-change":e.emitValue},model:{value:e.checkRulesArr[n].message,callback:function(t){e.$set(e.checkRulesArr[n],"message","string"===typeof t?t.trim():t)},expression:"checkRulesArr[index].message"}})],1)]:e._e(),t.name===e.RULE.phone?[a("div",{staticClass:"info"},[a("span",{staticClass:"param-tip"},[e._v("错误提示：")]),a("b-input",{attrs:{size:"small"},on:{"on-change":e.emitValue},model:{value:e.checkRulesArr[n].message,callback:function(t){e.$set(e.checkRulesArr[n],"message","string"===typeof t?t.trim():t)},expression:"checkRulesArr[index].message"}})],1)]:e._e(),t.name===e.RULE.regexp?[a("div",{staticClass:"info"},[a("b-row",{attrs:{gutter:10}},[a("b-col",{attrs:{span:"12"}},[a("span",{staticClass:"param-tip"},[e._v("正则规则：")]),a("b-input",{attrs:{size:"small",placeholder:"需输入字符格式"},on:{"on-change":e.emitValue},model:{value:e.checkRulesArr[n].regexp,callback:function(t){e.$set(e.checkRulesArr[n],"regexp","string"===typeof t?t.trim():t)},expression:"checkRulesArr[index].regexp"}})],1),a("b-col",{attrs:{span:"12"}},[a("span",{staticClass:"param-tip"},[e._v("错误提示：")]),a("b-input",{attrs:{size:"small"},on:{"on-change":e.emitValue},model:{value:e.checkRulesArr[n].message,callback:function(t){e.$set(e.checkRulesArr[n],"message","string"===typeof t?t.trim():t)},expression:"checkRulesArr[index].message"}})],1)],1)],1)]:e._e(),t.name===e.RULE.idCode?[a("div",{staticClass:"number"},[a("b-tooltip",{attrs:{content:"为空时独立校验"}},[a("span",{staticClass:"param-tip"},[e._v("前置字段：")])]),a("b-input",{attrs:{size:"small"},on:{"on-change":e.emitValue},nativeOn:{drop:function(t){return e.onDrop(t,n)},dragover:function(t){return e.allowDrop(t)}},model:{value:e.checkRulesArr[n].preField,callback:function(t){e.$set(e.checkRulesArr[n],"preField","string"===typeof t?t.trim():t)},expression:"checkRulesArr[index].preField"}})],1),a("div",{staticClass:"info"},[a("span",{staticClass:"param-tip"},[e._v("错误提示：")]),a("b-input",{attrs:{size:"small"},on:{"on-change":e.emitValue},model:{value:e.checkRulesArr[n].message,callback:function(t){e.$set(e.checkRulesArr[n],"message","string"===typeof t?t.trim():t)},expression:"checkRulesArr[index].message"}})],1),a("div",{staticClass:"number",staticStyle:{"padding-left":"10px"}},[a("span",{staticClass:"param-tip"},[e._v("忽略大小写：")]),a("b-switch",{attrs:{size:"small"},on:{"on-change":e.emitValue},model:{value:e.checkRulesArr[n].ignoreCase,callback:function(t){e.$set(e.checkRulesArr[n],"ignoreCase",t)},expression:"checkRulesArr[index].ignoreCase"}})],1)]:e._e(),t.name===e.RULE.unifiedCode?[a("div",{staticClass:"number"},[a("b-tooltip",{attrs:{content:"为空时独立校验"}},[a("span",{staticClass:"param-tip"},[e._v("前置字段：")])]),a("b-input",{attrs:{size:"small"},on:{"on-change":e.emitValue},nativeOn:{drop:function(t){return e.onDrop(t,n)},dragover:function(t){return e.allowDrop(t)}},model:{value:e.checkRulesArr[n].preField,callback:function(t){e.$set(e.checkRulesArr[n],"preField","string"===typeof t?t.trim():t)},expression:"checkRulesArr[index].preField"}})],1),a("div",{staticClass:"info"},[a("span",{staticClass:"param-tip"},[e._v("错误提示：")]),a("b-input",{attrs:{size:"small"},on:{"on-change":e.emitValue},model:{value:e.checkRulesArr[n].message,callback:function(t){e.$set(e.checkRulesArr[n],"message","string"===typeof t?t.trim():t)},expression:"checkRulesArr[index].message"}})],1),a("div",{staticClass:"number",staticStyle:{"padding-left":"10px"}},[a("span",{staticClass:"param-tip"},[e._v("忽略大小写：")]),a("b-switch",{attrs:{size:"small"},on:{"on-change":e.emitValue},model:{value:e.checkRulesArr[n].ignoreCase,callback:function(t){e.$set(e.checkRulesArr[n],"ignoreCase",t)},expression:"checkRulesArr[index].ignoreCase"}})],1)]:e._e(),t.name===e.RULE.orgInstCode?[a("div",{staticClass:"number"},[a("b-tooltip",{attrs:{content:"为空时独立校验"}},[a("span",{staticClass:"param-tip"},[e._v("前置字段：")])]),a("b-input",{attrs:{size:"small"},on:{"on-change":e.emitValue},nativeOn:{drop:function(t){return e.onDrop(t,n)},dragover:function(t){return e.allowDrop(t)}},model:{value:e.checkRulesArr[n].preField,callback:function(t){e.$set(e.checkRulesArr[n],"preField","string"===typeof t?t.trim():t)},expression:"checkRulesArr[index].preField"}})],1),a("div",{staticClass:"info"},[a("span",{staticClass:"param-tip"},[e._v("错误提示：")]),a("b-input",{attrs:{size:"small"},on:{"on-change":e.emitValue},model:{value:e.checkRulesArr[n].message,callback:function(t){e.$set(e.checkRulesArr[n],"message","string"===typeof t?t.trim():t)},expression:"checkRulesArr[index].message"}})],1),a("div",{staticClass:"number",staticStyle:{"padding-left":"10px"}},[a("span",{staticClass:"param-tip"},[e._v("忽略大小写：")]),a("b-switch",{attrs:{size:"small"},on:{"on-change":e.emitValue},model:{value:e.checkRulesArr[n].ignoreCase,callback:function(t){e.$set(e.checkRulesArr[n],"ignoreCase",t)},expression:"checkRulesArr[index].ignoreCase"}})],1)]:e._e(),t.name===e.RULE.regNo?[a("div",{staticClass:"number"},[a("b-tooltip",{attrs:{content:"为空时独立校验"}},[a("span",{staticClass:"param-tip"},[e._v("前置字段：")])]),a("b-input",{attrs:{size:"small"},on:{"on-change":e.emitValue},nativeOn:{drop:function(t){return e.onDrop(t,n)},dragover:function(t){return e.allowDrop(t)}},model:{value:e.checkRulesArr[n].preField,callback:function(t){e.$set(e.checkRulesArr[n],"preField",t)},expression:"checkRulesArr[index].preField"}})],1),a("div",{staticClass:"info"},[a("span",{staticClass:"param-tip"},[e._v("错误提示：")]),a("b-input",{attrs:{size:"small"},on:{"on-change":e.emitValue},model:{value:e.checkRulesArr[n].message,callback:function(t){e.$set(e.checkRulesArr[n],"message","string"===typeof t?t.trim():t)},expression:"checkRulesArr[index].message"}})],1),a("div",{staticClass:"number",staticStyle:{"padding-left":"10px"}},[a("span",{staticClass:"param-tip"},[e._v("忽略大小写：")]),a("b-switch",{attrs:{size:"small"},on:{"on-change":e.emitValue},model:{value:e.checkRulesArr[n].ignoreCase,callback:function(t){e.$set(e.checkRulesArr[n],"ignoreCase",t)},expression:"checkRulesArr[index].ignoreCase"}})],1)]:e._e(),t.name===e.RULE.conditionRequired?[a("div",{staticClass:"number"},[a("span",{staticClass:"param-tip"},[e._v("前置字段：")]),a("b-input",{attrs:{size:"small"},on:{"on-change":e.emitValue},nativeOn:{drop:function(t){return e.onDrop(t,n)},dragover:function(t){return e.allowDrop(t)}},model:{value:e.checkRulesArr[n].preField,callback:function(t){e.$set(e.checkRulesArr[n],"preField","string"===typeof t?t.trim():t)},expression:"checkRulesArr[index].preField"}})],1),a("div",{staticClass:"number"},[a("span",{staticClass:"param-tip"},[e._v("前置字段值：")]),a("b-input",{attrs:{size:"small"},on:{"on-change":e.emitValue},model:{value:e.checkRulesArr[n].preFieldValue,callback:function(t){e.$set(e.checkRulesArr[n],"preFieldValue","string"===typeof t?t.trim():t)},expression:"checkRulesArr[index].preFieldValue"}})],1),a("div",{staticClass:"info"},[a("span",{staticClass:"param-tip"},[e._v("错误提示：")]),a("b-input",{attrs:{size:"small"},on:{"on-change":e.emitValue},model:{value:e.checkRulesArr[n].message,callback:function(t){e.$set(e.checkRulesArr[n],"message","string"===typeof t?t.trim():t)},expression:"checkRulesArr[index].message"}})],1)]:e._e(),t.name===e.RULE.conditionNotRequired?[a("div",{staticClass:"number"},[a("span",{staticClass:"param-tip"},[e._v("前置字段：")]),a("b-input",{attrs:{size:"small"},on:{"on-change":e.emitValue},nativeOn:{drop:function(t){return e.onDrop(t,n)},dragover:function(t){return e.allowDrop(t)}},model:{value:e.checkRulesArr[n].preField,callback:function(t){e.$set(e.checkRulesArr[n],"preField","string"===typeof t?t.trim():t)},expression:"checkRulesArr[index].preField"}})],1),a("div",{staticClass:"number"},[a("span",{staticClass:"param-tip"},[e._v("前置字段值：")]),a("b-input",{attrs:{size:"small"},on:{"on-change":e.emitValue},model:{value:e.checkRulesArr[n].preFieldValue,callback:function(t){e.$set(e.checkRulesArr[n],"preFieldValue","string"===typeof t?t.trim():t)},expression:"checkRulesArr[index].preFieldValue"}})],1),a("div",{staticClass:"info"},[a("span",{staticClass:"param-tip"},[e._v("错误提示：")]),a("b-input",{attrs:{size:"small"},on:{"on-change":e.emitValue},model:{value:e.checkRulesArr[n].message,callback:function(t){e.$set(e.checkRulesArr[n],"message","string"===typeof t?t.trim():t)},expression:"checkRulesArr[index].message"}})],1)]:e._e(),t.name===e.RULE.conditionNotBe?[a("div",{staticClass:"number"},[a("span",{staticClass:"param-tip"},[e._v("前置字段：")]),a("b-input",{attrs:{size:"small"},on:{"on-change":e.emitValue},nativeOn:{drop:function(t){return e.onDrop(t,n)},dragover:function(t){return e.allowDrop(t)}},model:{value:e.checkRulesArr[n].preField,callback:function(t){e.$set(e.checkRulesArr[n],"preField","string"===typeof t?t.trim():t)},expression:"checkRulesArr[index].preField"}})],1),a("div",{staticClass:"number"},[a("span",{staticClass:"param-tip"},[e._v("前置字段值：")]),a("b-input",{attrs:{size:"small"},on:{"on-change":e.emitValue},model:{value:e.checkRulesArr[n].preFieldValue,callback:function(t){e.$set(e.checkRulesArr[n],"preFieldValue","string"===typeof t?t.trim():t)},expression:"checkRulesArr[index].preFieldValue"}})],1),a("div",{staticClass:"number"},[a("span",{staticClass:"param-tip"},[e._v("不是某值：")]),a("b-input",{attrs:{size:"small"},on:{"on-change":e.emitValue},model:{value:e.checkRulesArr[n].notValue,callback:function(t){e.$set(e.checkRulesArr[n],"notValue","string"===typeof t?t.trim():t)},expression:"checkRulesArr[index].notValue"}})],1),a("div",{staticClass:"info"},[a("span",{staticClass:"param-tip"},[e._v("错误提示：")]),a("b-input",{attrs:{size:"small"},on:{"on-change":e.emitValue},model:{value:e.checkRulesArr[n].message,callback:function(t){e.$set(e.checkRulesArr[n],"message","string"===typeof t?t.trim():t)},expression:"checkRulesArr[index].message"}})],1)]:e._e(),t.name===e.RULE.notSame?[a("div",{staticClass:"number"},[a("span",{staticClass:"param-tip"},[e._v("前置字段：")]),a("b-input",{attrs:{size:"small"},on:{"on-change":e.emitValue},nativeOn:{drop:function(t){return e.onDrop(t,n)},dragover:function(t){return e.allowDrop(t)}},model:{value:e.checkRulesArr[n].preField,callback:function(t){e.$set(e.checkRulesArr[n],"preField","string"===typeof t?t.trim():t)},expression:"checkRulesArr[index].preField"}})],1),a("div",{staticClass:"info"},[a("span",{staticClass:"param-tip"},[e._v("错误提示：")]),a("b-input",{attrs:{size:"small"},on:{"on-change":e.emitValue},model:{value:e.checkRulesArr[n].message,callback:function(t){e.$set(e.checkRulesArr[n],"message","string"===typeof t?t.trim():t)},expression:"checkRulesArr[index].message"}})],1)]:e._e(),t.name===e.RULE.timeBound?[a("div",{staticClass:"number"},[a("span",{staticClass:"param-tip"},[e._v("比较模式：")]),a("b-select",{attrs:{size:"small"},on:{"on-change":e.emitValue},model:{value:e.checkRulesArr[n].compareMode,callback:function(t){e.$set(e.checkRulesArr[n],"compareMode",t)},expression:"checkRulesArr[index].compareMode"}},[a("b-option",{attrs:{value:"gt"}},[e._v(">")]),a("b-option",{attrs:{value:"ge"}},[e._v("≥")]),a("b-option",{attrs:{value:"lt"}},[e._v("<")]),a("b-option",{attrs:{value:"le"}},[e._v("≤")])],1)],1),a("div",{staticClass:"number"},[a("b-tooltip",{attrs:{content:"$now/yyyy-MM-dd/preField"}},[a("span",{staticClass:"param-tip"},[e._v("比较值/字段：")])]),a("b-input",{attrs:{size:"small"},on:{"on-change":e.emitValue},nativeOn:{drop:function(t){return e.onDrop(t,n)},dragover:function(t){return e.allowDrop(t)}},model:{value:e.checkRulesArr[n].time,callback:function(t){e.$set(e.checkRulesArr[n],"time","string"===typeof t?t.trim():t)},expression:"checkRulesArr[index].time"}})],1),a("div",{staticClass:"info"},[a("span",{staticClass:"param-tip"},[e._v("错误提示：")]),a("b-input",{attrs:{size:"small"},on:{"on-change":e.emitValue},model:{value:e.checkRulesArr[n].message,callback:function(t){e.$set(e.checkRulesArr[n],"message","string"===typeof t?t.trim():t)},expression:"checkRulesArr[index].message"}})],1)]:e._e(),a("div",{staticClass:"delete"},[a("b-button",{attrs:{type:"text","text-color":"#f5222d",disabled:"Y"===e.required&&t.name===e.RULE.required},on:{click:function(t){return e.removeRules(n)}}},[a("b-icon",{attrs:{name:"ios-remove-circle-outline",size:"22"}})],1)],1)],2)])})),0)],1),e.showReal?a("div",[a("b-tag",{attrs:{type:"success",size:"small"}},[e._v("实际存储对象")]),a("b-ace-editor",{attrs:{value:JSON.stringify(e.checkRulesArr,null,2),readonly:"",height:"240"}})],1):e._e()],1)},ae=[];function ne(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function re(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ne(a,!0).forEach((function(t){ie(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ne(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function ie(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var se={name:"Validator",components:{VToggleShow:G,Draggable:p.a},props:{value:{type:String},fieldName:{type:String},fieldTitle:{type:String},required:{type:String},controlType:{type:String},dataType:{type:String},originalRules:{type:Object},dataLength:Number},data:function(){return{showReal:!1,isRequired:!1,rulesObj:null,checkRulesArr:[]}},computed:{RULE:function(){return L},ruleNameMap:function(){return F},triggerType:function(){return["TEXT","TEXTAREA"].indexOf(this.controlType)>-1?"blur":"change"},normalCfg:function(){return{type:"number"===this.dataType?"number":"string",trigger:this.triggerType}}},watch:{value:{handler:function(e){try{var t=JSON.parse(e);t.rules?(this.$log.warning("旧格式重置"),this.refreshRule()):("array"===Object(l["d"])(t)?this.checkRulesArr=t:this.refreshRule(),this.isRequired=this.hasRequired())}catch(a){this.$log.danger("非标准json初始化"),this.refreshRule()}},immediate:!0},required:function(e){"Y"===e&&(this.isRequired=!0,this.setRules(L.required))}},methods:{setRules:function(e){if(e!==L.required||!this.hasRequired())if(this.hasSame(e))this.$message({type:"warning",content:"已有同名规则，无需重复添加"});else{switch(e){case L.required:this.checkRulesArr.unshift(re({name:e,message:"".concat(this.fieldTitle,"必填")},this.normalCfg));break;case L.length:this.checkRulesArr.push(re({name:e,min:1/0,max:1/0,message:"长度必须在指定的范围内"},this.normalCfg));break;case L.email:this.checkRulesArr.push(re({name:e,message:"邮箱格式不正确"},this.normalCfg));break;case L.phone:this.checkRulesArr.push(re({name:e,message:"手机号格式不正确"},this.normalCfg));break;case L.regexp:this.checkRulesArr.push(re({name:e,regexp:"",message:"正则表达式不匹配"},this.normalCfg));break;case L.idCode:this.checkRulesArr.push(re({name:e,preField:"id_type",message:"身份证格式不正确",ignoreCase:!0},this.normalCfg));break;case L.unifiedCode:this.checkRulesArr.push(re({name:e,preField:"id_type",message:"统一社会信用代码格式不正确",ignoreCase:!0},this.normalCfg));break;case L.orgInstCode:this.checkRulesArr.push(re({name:e,preField:"id_type",message:"组织机构代码格式不正确",ignoreCase:!0},this.normalCfg));break;case L.regNo:this.checkRulesArr.push(re({name:e,preField:"id_type",message:"工商注册号格式不正确",ignoreCase:!0},this.normalCfg));break;case L.conditionRequired:this.checkRulesArr.push(re({name:e,preField:"",preFieldValue:"",message:"当前字段在前置字段条件达成下必填"},this.normalCfg));break;case L.conditionNotRequired:this.checkRulesArr.push(re({name:e,preField:"",preFieldValue:"",message:"当前字段在前置字段条件达成下不可填写"},this.normalCfg));break;case L.conditionNotBe:this.checkRulesArr.push(re({name:e,preField:"",preFieldValue:"",notValue:"",message:"当前字段在前置字段条件达成下不能为某值"},this.normalCfg));break;case L.notSame:this.checkRulesArr.push(re({name:e,preField:"",message:"不能和前置字段值相同"},this.normalCfg));break;case L.timeBound:this.checkRulesArr.push(re({name:e,time:"$now",compareMode:"gt",message:"日期不符合区间设置"},this.normalCfg));break;default:break}this.emitValue()}},removeRules:function(e){this.checkRulesArr.splice(e,1),this.emitValue()},requiredChange:function(e){e?this.setRules(L.required):(this.checkRulesArr=this.checkRulesArr.filter((function(e){return e.name!==L.required})),this.emitValue())},reload:function(){this.originalRules&&(this.$emit("input",this.originalRules[this.fieldName]),this.$emit("on-change",this.originalRules[this.fieldName]))},refreshRule:function(){this.checkRulesArr=[],"Y"===this.required?(this.setRules(L.required),this.addLengthRule()):(this.addLengthRule(),this.emitEmptyValue())},addLengthRule:function(){"string"===this.dataType&&this.checkRulesArr.push(re({name:L.length,min:null,max:this.dataLength,message:"长度必须在指定的范围内"},this.normalCfg))},emitValue:function(){var e=JSON.stringify(this.checkRulesArr);this.$emit("input",e),this.$emit("on-change",e)},emitEmptyValue:function(){var e=JSON.stringify([]);this.$emit("input",e),this.$emit("on-change",e)},onDragEnd:function(e){var t=e.oldIndex,a=e.newIndex;t!==a&&this.emitValue()},hasRequired:function(){var e=this.hasSameNameItem(L.required);return!!e},hasSameNameItem:function(e){return this.checkRulesArr.find((function(t){return t.name===e}))},hasSame:function(e){var t=[L.regexp,L.conditionRequired,L.conditionNotRequired,L.conditionNotBe,L.notSame,L.timeBound];return!(t.indexOf(e)>-1)&&!!this.hasSameNameItem(e)},ruleStyle:function(e){return["$conditionRequired","$conditionNotRequired","$conditionNotBe","$notSame","$timeBound"].indexOf(e)>-1?"success":"primary"},allowDrop:function(e){e.preventDefault()},onDrop:function(e,t){this.checkRulesArr[t].hasOwnProperty("preField")&&(this.checkRulesArr[t].preField=e.dataTransfer.getData("index")),this.checkRulesArr[t].hasOwnProperty("time")&&(this.checkRulesArr[t].time=e.dataTransfer.getData("index")),this.emitValue(),e.preventDefault()}}},oe=se,le=(a("9028"),Object(g["a"])(oe,te,ae,!1,null,"7b037bb6",null)),ce=le.exports;function ue(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function de(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ue(a,!0).forEach((function(t){pe(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ue(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function pe(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var me={name:"FieldsCfg",components:{Validator:ce,ValidValue:ee,VDragItems:v},data:function(){return{enumMap:o,fieldsColumns:[{type:"index",width:50,align:"center"},{title:"名称",key:"fieldName"},{title:"标题",key:"fieldTitle"}],totalData:[],personIds:[],currentIndex:-1,originalRules:null}},props:{value:{type:Array,default:function(){return[]}},maxHeight:{type:Number}},watch:{value:{handler:function(e){if(0===e.length)return this.currentIndex=-1,this.totalData=[],void(this.$refs.dragItems&&this.$refs.dragItems.clearSelect());if(!this.originalRules){var t={};e.forEach((function(e){t[e.fieldName]=e.checkRules})),this.originalRules=t}this.personIds=e.filter((function(e){return e.fieldName.indexOf("person_id")>-1})),this.totalData=this.formatItems(e).filter((function(e){return-1===e.fieldName.indexOf("person_id")})),this.totalData.length>0&&-1===this.currentIndex&&(this.currentIndex=0)},immediate:!0}},computed:{tokenizerDisabled:function(){if(-1!==this.currentIndex){var e=this.totalData[this.currentIndex];return"string"!==e.dataType||e.validValue&&e.validValue.length>0}return!1},showValidValue:function(){if(-1!==this.currentIndex){var e=this.totalData[this.currentIndex];return"string"===e.dataType&&["SELECT","MULTIPLE_SELECT"].indexOf(e.controlType)>-1}return!1},controlTypeFilter:function(){if(-1===this.currentIndex)return[];var e=this.enumMap.controlType,t=this.totalData[this.currentIndex].dataType;switch(t){case"number":return{NUMBER_TEXT:"数值文本框"};case"date":return{TEXT:"文本框",DATE:"日期"};case"datetime":return{TEXT:"文本框",DATE_TIME:"日期时间"};case"text":return{TEXT:"文本框",TEXTAREA:"文本域"};case"string":return{TEXT:"文本框",SELECT:"下拉框",MULTIPLE_SELECT:"多选下拉框",DATE:"日期",DATE_TIME:"日期时间",TEXTAREA:"文本域"};default:return e}}},methods:{formatItems:function(e){return e.map((function(e){var t=de({},e);return t.tokenizer?t.validValue&&t.validValue.length>0&&(t.tokenizer="N"):"string"===t.dataType?t.tokenizer=t.validValue&&t.validValue.length>0?"N":"":(t.validValue="",t.tokenizer=""),t}))},handleSelect:function(e){this.currentIndex=e,this.$refs.rightPanel.scrollTop=0},handleDrag:function(){this.resetHandle("重排成功")},controlTypeChange:function(e){-1===["SELECT","MULTIPLE_SELECT"].indexOf(e)?this.totalData[this.currentIndex].validValue="":this.totalData[this.currentIndex].tokenizer="N";var t="TEXT"===e||"TEXTAREA"===e?"blur":"change";try{var a=JSON.parse(this.totalData[this.currentIndex].checkRules);Object.keys(a).forEach((function(e){a[e]["trigger"]=t})),this.totalData[this.currentIndex].checkRules=JSON.stringify(a)}catch(n){console.warn("校验字符串格式化失败")}this.emitValue()},resetHandle:function(e){this.currentIndex=-1,this.emitValue(),this.$message({type:"success",content:e})},emitValue:function(){this.$emit("input",this.totalData.concat(this.personIds)),this.$emit("on-change",this.totalData.concat(this.personIds))}}},he=me,fe=(a("9b54"),Object(g["a"])(he,i,s,!1,null,"21698ba0",null)),ge=fe.exports,be=a("024d"),ve=a("c66e"),ye={name:"FormItem",props:{controlType:{type:String,default:"TEXT"},label:{type:String,required:!0},prop:{type:String,required:!0}},render:function(e){var t;return t=e("b-form-item",{props:{label:this.label,prop:this.prop}},this.$slots.default),e("div",{style:this.wrapStyle},[t])},computed:{wrapStyle:function(){return{width:["FILE_UPLOAD","TEXTAREA"].indexOf(this.controlType)>-1?"100%":"25%",display:"inline-block",padding:"0 5px"}}}},xe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{flex:""}},[a("b-input",{attrs:{placeholder:e.placeholder,readonly:"",clearable:""},on:{"on-clear":e.handleClear},model:{value:e.current,callback:function(t){e.current=t},expression:"current"}}),a("b-button",{staticStyle:{flex:"0 0 auto","margin-left":"0"},attrs:{type:"primary",plain:""},on:{click:e.handleShowModal}},[e._v("\n    选择\n  ")]),a("leg-person-modal",{ref:"modal",on:{"choose-one":e.handleChooseOne}})],1)},ke=[],_e=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-modal",{attrs:{title:"选择法人",width:"860","append-to-body":"","mask-closable":!1},model:{value:e.dialogFormVisible,callback:function(t){e.dialogFormVisible=t},expression:"dialogFormVisible"}},[a("div",{staticStyle:{padding:"0"}},[a("v-filter-bar",{on:{"keyup-enter":e.handleFilter}},[a("v-filter-item",{attrs:{title:"名称"}},[a("b-input",{attrs:{placeholder:"输入名称",clearable:""},model:{value:e.listQuery.compName,callback:function(t){e.$set(e.listQuery,"compName","string"===typeof t?t.trim():t)},expression:"listQuery.compName"}})],1),a("v-filter-item",{on:{"on-search":e.handleFilter,"on-reset":e.resetQuery}})],1),a("b-table",{attrs:{columns:e.columns,data:e.list,loading:e.listLoading,size:"small"},scopedSlots:e._u([{key:"action",fn:function(t){var n=t.row;return[a("b-button",{attrs:{type:"text"},on:{click:function(t){return e.chooseOne(n)}}},[e._v("选择")])]}}])})],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("b-page",{attrs:{total:e.total,current:e.listQuery.page},on:{"update:current":function(t){return e.$set(e.listQuery,"page",t)},"on-change":e.handleCurrentChange}})],1)])},Ce=[],Re={name:"LegPersonModal",mixins:[U["a"]],data:function(){return{dialogFormVisible:!1,listQuery:{compName:""},columns:[{title:"名称",key:"compName"},{title:"证件类型",key:"idTypeName"},{title:"证件号码",key:"idCode"},{title:"操作",slot:"action",width:100}]}},watch:{value:{handler:function(e){this.current=e},immediate:!0}},methods:{open:function(){this.dialogFormVisible=!0,this.resetQuery()},resetQuery:function(){this.listQuery={page:1,size:10,compName:""},this.handleFilter()},chooseOne:function(e){this.$emit("choose-one",e),this.dialogFormVisible=!1},searchList:function(){var e=this;this.setListData(),A(this.listQuery).then((function(t){200===t.status&&e.setListData({list:t.data.rows,total:t.data.total})}))}}},we=Re,De=Object(g["a"])(we,_e,Ce,!1,null,null,null),Te=De.exports,Ee={name:"SelectLegInput",components:{LegPersonModal:Te},props:{value:{type:String,default:""},placeholder:{type:String,default:""}},data:function(){return{current:""}},watch:{value:{handler:function(e){this.current=e},immediate:!0}},methods:{handleShowModal:function(){this.$refs.modal&&this.$refs.modal.open()},handleChooseOne:function(e){var t={idShxym:e.idShxym||"",idGszc:e.idGszc||"",idZzjg:e.idZzjg||"",idSwdj:e.idSwdj||"",idSydw:e.idSydw||"",idShzz:e.idShzz||""},a={id:e.id,name:e.compName,idType:e.idType,idCode:e.idCode};this.$emit("on-select",a,"leg",t)},handleClear:function(){this.$emit("on-select",{id:"",name:"",idType:"",idCode:""},"leg",{idShxym:"",idGszc:"",idZzjg:"",idSwdj:"",idSydw:"",idShzz:""})}}},Oe=Ee,Se=Object(g["a"])(Oe,xe,ke,!1,null,null,null),Ae=Se.exports,$e=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{flex:""}},[a("b-input",{attrs:{placeholder:e.placeholder,readonly:"",clearable:""},on:{"on-clear":e.handleClear},model:{value:e.current,callback:function(t){e.current=t},expression:"current"}}),a("b-button",{staticStyle:{flex:"0 0 auto","margin-left":"0"},attrs:{type:"primary",plain:""},on:{click:e.handleShowModal}},[e._v("\n    选择\n  ")]),a("nat-person-modal",{ref:"modal",on:{"choose-one":e.handleChooseOne}})],1)},Ne=[],Ie=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("b-modal",{attrs:{title:"选择自然人",width:"860","append-to-body":"","mask-closable":!1},model:{value:e.dialogFormVisible,callback:function(t){e.dialogFormVisible=t},expression:"dialogFormVisible"}},[a("div",{staticStyle:{padding:"0"}},[a("v-filter-bar",{on:{"keyup-enter":e.handleFilter}},[a("v-filter-item",{attrs:{title:"名称"}},[a("b-input",{attrs:{placeholder:"输入名称",clearable:""},model:{value:e.listQuery.name,callback:function(t){e.$set(e.listQuery,"name","string"===typeof t?t.trim():t)},expression:"listQuery.name"}})],1),a("v-filter-item",{on:{"on-search":e.handleFilter,"on-reset":e.resetQuery}})],1),a("b-table",{attrs:{columns:e.columns,data:e.list,loading:e.listLoading,size:"small"},scopedSlots:e._u([{key:"action",fn:function(t){var n=t.index;return[a("b-button",{attrs:{type:"text"},on:{click:function(t){return e.chooseOne(n)}}},[e._v("选择")])]}}])})],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("b-page",{attrs:{total:e.total,current:e.listQuery.page},on:{"update:current":function(t){return e.$set(e.listQuery,"page",t)},"on-change":e.handleCurrentChange}})],1)])},Le=[],Fe=a("27ae");function Ve(e){return e&&e.length>6?Fe["Base64"].decode(e.slice(6)):""}function je(e,t){var a=e;return null==e||""===e?a:("ID_CODE"===t?18===e.length&&(a=e.substr(0,6)+"********"+e.substr(14)):"MOBILE_PHONE"===t&&11===e.length&&(a=e.substr(0,3)+"****"+e.substr(7)),a)}function ze(e){return Pe(6)+Fe["Base64"].encode(e)}function Pe(e){for(var t="",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=a.length,r=0;r<e;r++)t+=a.charAt(Math.floor(Math.random()*n));return t}function Me(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function qe(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Me(a,!0).forEach((function(t){Be(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Me(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Be(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Ue={name:"NatPersonModal",mixins:[U["a"]],data:function(){return{dialogFormVisible:!1,listQuery:{name:""},columns:[{title:"名称",key:"name"},{title:"证件类型",key:"idTypeName"},{title:"证件号码",key:"idCode"},{title:"操作",slot:"action",width:100}],noMaskList:[]}},methods:{open:function(){this.dialogFormVisible=!0,this.resetQuery()},resetQuery:function(){this.listQuery={page:1,size:10,name:""},this.handleFilter()},chooseOne:function(e){var t=this.noMaskList[e];this.$emit("choose-one",t),this.dialogFormVisible=!1},searchList:function(){var e=this;this.setListData(),$(this.listQuery).then((function(t){200===t.status&&(e.setListData({list:e.decodeAndMaskFormat(t.data.rows,!0),total:t.data.total}),e.noMaskList=e.decodeAndMaskFormat(t.data.rows))}))},decodeAndMaskFormat:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=[];return e.forEach((function(e){var n=qe({},e);Object.keys(n).forEach((function(a){"idCode"===a&&(n[a]=t?je(Ve(e[a]),"ID_CODE"):Ve(e[a]))})),a.push(n)})),a}}},Qe=Ue,Xe=Object(g["a"])(Qe,Ie,Le,!1,null,null,null),Je=Xe.exports,Ye={name:"SelectNatInput",components:{NatPersonModal:Je},props:{value:{type:String,default:""},placeholder:{type:String,default:""}},data:function(){return{current:""}},watch:{value:{handler:function(e){this.current=e},immediate:!0}},methods:{handleShowModal:function(){this.$refs.modal&&this.$refs.modal.open()},handleChooseOne:function(e){var t={id:e.id,name:e.name,idType:e.idType,idCode:e.idCode};this.$emit("on-select",t,"nat",null)},handleClear:function(){this.$emit("on-select",{id:"",name:"",idType:"",idCode:""},"nat",null)}}},Ke=Ye,Ge=Object(g["a"])(Ke,$e,Ne,!1,null,null,null),We=Ge.exports,He=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{flex:""}},[a("b-input",{attrs:{placeholder:e.placeholder,readonly:"",clearable:""},on:{"on-clear":e.handleClear},model:{value:e.current,callback:function(t){e.current=t},expression:"current"}}),a("b-dropdown",{staticStyle:{flex:"0 0 80px","margin-left":"0"},on:{"on-click":e.handleClick}},[a("b-button",{attrs:{type:"primary",plain:""}},[e._v("\n      "+e._s(e.showText)+"\n      "),a("b-icon",{attrs:{name:"ios-arrow-down"}})],1),a("b-dropdown-menu",{attrs:{slot:"list"},slot:"list"},[a("b-dropdown-item",{attrs:{name:"nat",selected:"nat"===e.type}},[e._v("自然人")]),a("b-dropdown-item",{attrs:{name:"leg",selected:"leg"===e.type}},[e._v("法 人")])],1)],1),a("nat-person-modal",{ref:"nat",on:{"choose-one":e.handleChooseNat}}),a("leg-person-modal",{ref:"leg",on:{"choose-one":e.handleChooseLeg}})],1)},Ze=[],et={name:"SelectNatOrLeg",components:{LegPersonModal:Te,NatPersonModal:Je},props:{value:{type:String,default:""},placeholder:{type:String,default:""}},data:function(){return{current:"",type:""}},watch:{value:{handler:function(e){this.current=e},immediate:!0}},computed:{showText:function(){return""===this.type?"选择":{nat:"自然人",leg:"法 人"}[this.type]}},methods:{handleClick:function(e){this.$refs[e]&&this.$refs[e].open()},handleChooseNat:function(e){this.type="nat";var t={id:e.id,name:e.name,idType:e.idType,idCode:e.idCode};this.$emit("on-select",t,"nat",null)},handleChooseLeg:function(e){this.type="leg";var t={id:e.id,name:e.compName,idType:e.idType,idCode:e.idCode};this.$emit("on-select",t)},handleClear:function(){this.type="",this.$emit("on-select",{id:"",name:"",idType:"",idCode:""},"natOrLeg",null)}}},tt=et,at=Object(g["a"])(tt,He,Ze,!1,null,null,null),nt=at.exports,rt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"file-upload-wrap",style:{width:e.isShow?"100%":"25%"}},[e.isShow?a("ul",{staticClass:"file-list"},e._l(e.fileList,(function(t,n){return a("li",{key:n,staticClass:"file-item"},[a("span",{class:["file-name",{success:t.id&&e.result}],attrs:{title:"下载: "+t.name},on:{click:function(a){return e.handleDownload(t.id,t.name)}}},[a("b-icon",{attrs:{name:e.format(t)}}),e._v(" "+e._s(t.name)+"\n      ")],1)])})),0):[a("div",{staticClass:"file-upload"},[a("input",{ref:"input",staticClass:"file-input",attrs:{type:"file",multiple:e.multiple,accept:e.accept},on:{change:e.handleChange}}),e._t("default",[a("b-button",{attrs:{type:"primary",icon:"ios-open",plain:""},on:{click:e.handleClick}},[e._v("选择文件")])]),e.fileList.length>0&&!e.result?a("b-button",{attrs:{type:"success",plain:"",loading:e.loadingStatus,icon:"ios-cloud-upload"},on:{click:e.handleUpload}},[e._v("上传\n      ")]):e._e()],2),e.tip&&0===e.fileList.length?a("div",{staticClass:"file-tip"},[e._v(e._s(e.tip))]):e._e(),a("ul",{staticClass:"file-list"},e._l(e.fileList,(function(t,n){return a("li",{key:n,staticClass:"file-item upload"},[a("span",{class:["file-name",{success:t.id&&e.result}],on:{click:function(a){return e.handleDownload(t.id,t.name)}}},[a("b-icon",{attrs:{name:e.format(t)}}),e._v(" "+e._s(t.name)+"\n      ")],1),e.result?a("b-icon",{staticClass:"list-item-success",attrs:{name:"ios-checkmark-circle-outline"}}):a("b-icon",{staticClass:"list-item-remove",attrs:{name:"ios-close"},nativeOn:{click:function(t){return e.handleRemove(n)}}})],1)})),0)]],2)},it=[];function st(e,t){var a="/api/dir/attachment/upload",n=new FormData;return Object(O["a"])(n,"resourceKey",e),Object(O["a"])(n,"uploadFile",t),Object(O["c"])(a,n)}function ot(e){return Object(O["b"])({url:"/api/dir/attachment/list",method:"get",params:{ids:e}})}function lt(e){return Object(O["b"])({url:"/api/dir/attachment/download",method:"get",responseType:"blob",params:{id:e}})}var ct=a("f348");function ut(e,t,a){this.$children.forEach(n=>{const r=n.$options.name;r===e?n.$emit.apply(n,[t].concat(a)):ut.apply(n,[e,t].concat([a]))})}var dt={methods:{dispatch(e,t,a){let n=this.$parent||this.$root,r=n.$options.name;while(n&&(!r||r!==e))n=n.$parent,n&&(r=n.$options.name);n&&n.$emit.apply(n,[t].concat(a))},broadcast(e,t,a){ut.call(this,e,t,a)}}},pt={name:"FileUpload",mixins:[dt],props:{value:{type:String},resourceKey:{type:String,required:!0},multiple:{type:Boolean,default:!0},accept:{type:String},isShow:{type:Boolean},tip:String,maxSize:{type:Number}},data:function(){return{fileList:[],loadingStatus:!1,result:!1,ids:""}},watch:{value:{handler:function(e){this.ids=e,e.length>0&&0===this.fileList.length&&this.handleSearchFileList()},immediate:!0}},methods:{format:function(e){var t=e.name.split(".").pop().toLocaleLowerCase()||"",a="ios-document-outline";return["gif","jpg","jpeg","png","bmp","webp"].indexOf(t)>-1&&(a="ios-image"),["mp4","m3u8","rmvb","avi","swf","3gp","mkv","flv"].indexOf(t)>-1&&(a="ios-film"),["mp3","wav","wma","ogg","aac","flac"].indexOf(t)>-1&&(a="ios-musical-notes"),["doc","txt","docx","pages","epub","pdf"].indexOf(t)>-1&&(a="ios-document"),["numbers","csv","xls","xlsx"].indexOf(t)>-1&&(a="ios-stats"),["keynote","ppt","pptx"].indexOf(t)>-1&&(a="ios-videocam"),a},handleClick:function(){this.$refs.input.click()},handleRemove:function(e){this.fileList.splice(e,1),0===this.fileList.length&&this.emitValue("")},handleChange:function(e){var t=this,a=e.target.files;if(a){var n=Array.prototype.slice.call(a);this.maxSize&&0!==this.maxSize?(this.fileList=n.filter((function(e){return e.size<1024*t.maxSize})),this.fileList.length!==n.length&&this.$message({type:"warning",content:"超出最大限制的文件已被过滤！"})):this.fileList=n,0===this.fileList.length&&this.emitValue(""),this.loadingStatus=!1,this.result=!1}},handleUpload:function(){var e=this,t=[];this.fileList.forEach((function(a){t.push(st(e.resourceKey,a))})),this.loadingStatus=!0,Promise.all(t).then((function(t){e.result=t.every((function(e){return"0"===e.data.code})),e.result&&(e.ids=t.map((function(e){return e.data.data})).join(","),e.emitValue(e.ids)),e.loadingStatus=!1}))},emitValue:function(e){this.$emit("input",e),this.dispatch("BFormItem","on-form-change",e)},handleSearchFileList:function(){var e=this;ot(this.ids).then((function(t){200===t.status&&(e.fileList=t.data.rows.map((function(e){return{id:e.id,name:e.fileName,fileUrl:e.fileUrl}})),e.result=!0)}))},handleDownload:function(e,t){e&&(this.downloadEvent||(this.downloadEvent=this.$util.debounce((function(e,t){lt(e).then((function(e){200===e.status&&ct["a"].downloadFile(e.data,t)}))}),1e3)),this.downloadEvent(e,t))}}},mt=pt,ht=(a("8811"),Object(g["a"])(mt,rt,it,!1,null,"7c7aa1b7",null)),ft=ht.exports,gt=a("7b4e");function bt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function vt(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?bt(a,!0).forEach((function(t){yt(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):bt(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function yt(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var xt={name:"FormControl",components:{SelectLegInput:Ae,SelectNatInput:We,SelectNatOrLeg:nt,FileUpload:ft},data:function(){return{currentValue:"",items:[],number:0}},props:{value:{type:[String,Number],default:""},resourceKey:{type:String,required:!0},controlType:{type:String,default:"TEXT"},fieldName:{type:String,default:""},fieldTitle:{type:String,default:""},fieldDesc:{type:String,default:""},dataLength:{type:Number},dataPrecision:{type:Number},options:{type:Array,default:function(){return[]}},tableName:{type:String,default:""}},render:function(e){var t,a=(0===this.fieldName.indexOf("id_code")||0===this.fieldName.indexOf("id_type"))&&"leg_base_info"!==this.tableName&&"nat_base_info"!==this.tableName;switch(this.controlType){case"TEXT":t=e("b-input",{props:{value:this.currentValue,maxlength:this.dataLength,placeholder:"".concat(this.fieldDesc?this.fieldDesc:"请输入"+this.fieldTitle),disabled:a,clearable:!a},on:{input:this.handleInput}});break;case"NUMBER_TEXT":t=e("b-input-number",{props:{value:this.currentValue?Number(this.currentValue):null,precision:this.dataPrecision,disabled:a,clearable:!a},style:{width:"100%"},on:{"on-change":this.handleInput}});break;case"TEXTAREA":t=e("b-input",{props:{value:this.currentValue,maxlength:this.dataLength,placeholder:"".concat(this.fieldDesc?this.fieldDesc:"请输入"+this.fieldTitle),autosize:{minRows:1,maxRows:4},type:"textarea"},on:{input:this.handleInput}});break;case"DATE":t=e("b-date-picker",{props:{value:this.currentValue,placeholder:"".concat(this.fieldDesc?this.fieldDesc:"请选择"+this.fieldTitle),appendToBody:!0},on:{"on-change":this.handleInput}});break;case"DATE_TIME":t=e("b-date-picker",{props:{type:"datetime",value:this.currentValue,placeholder:"".concat(this.fieldDesc?this.fieldDesc:"请选择"+this.fieldTitle),appendToBody:!0},on:{"on-change":this.handleInput}});break;case"SELECT":t=e("b-select",{props:{value:this.currentValue,placeholder:"".concat(this.fieldDesc?this.fieldDesc:"请选择"+this.fieldTitle),disabled:a,clearable:!a,appendToBody:!0},on:{"on-change":this.handleInput}},this.options.map((function(t){return e("b-option",{props:{value:t.code}},[t.name])})));break;case"MULTIPLE_SELECT":t=e("b-select",{props:{value:this.currentValue.split(","),placeholder:"".concat(this.fieldDesc?this.fieldDesc:"请选择"+this.fieldTitle),disabled:a,clearable:!a,appendToBody:!0,multiple:!0,maxTagCount:2},on:{"on-change":this.handleInputMultiple}},this.options.map((function(t){return e("b-option",{props:{value:t.code}},[t.name])})));break;case"LEG_PERSON":t=e("select-leg-input",{props:{value:this.currentValue,placeholder:"选择法人"},on:{"on-select":this.handleSelectNatOrLeg}});break;case"NAT_PERSON":t=e("select-nat-input",{props:{value:this.currentValue,placeholder:"选择自然人"},on:{"on-select":this.handleSelectNatOrLeg}});break;case"NAT_OR_LEG_PERSON":t=e("select-nat-or-leg",{props:{value:this.currentValue,placeholder:"选择自然人或法人"},on:{"on-select":this.handleSelectNatOrLeg}});break;case"FILE_UPLOAD":t=e("file-upload",{props:{value:this.currentValue,resourceKey:this.resourceKey,tip:"不能上传大于100M的文件",maxSize:102400},on:{input:this.handleInput}});break;default:t=e("b-input",{props:{value:"没有 ".concat(this.controlType," 类型的控件"),disabled:!0}});break}return t},watch:{value:{handler:function(e){this.currentValue=e},immediate:!0}},methods:{handleInput:function(e){this.currentValue=e,this.$emit("input",this.currentValue)},handleInputMultiple:function(e){this.currentValue=e.join(","),this.$emit("input",this.currentValue)},handleSelectNatOrLeg:function(e,t,a){var n=Object(gt["a"])(this.fieldName,["name","comp_name"])?"":this.fieldName.slice("id_name".length),r={};r["person_id".concat(n)]=e.id,r[this.fieldName]=e.name,r["id_type".concat(n)]=e.idType,r["id_code".concat(n)]=e.idCode;var i=vt({},r);"leg"===t&&a&&("leg_xzxk_info"===this.tableName&&(i=vt({},r,{},{xk_xdr_shxym:a.idShxym,xk_xdr_gszc:a.idGszc,xk_xdr_zzjg:a.idZzjg,xk_xdr_swdj:a.idSwdj,xk_xdr_sydw:a.idSydw,xk_xdr_shzz:a.idShzz})),"leg_xzcf_info"===this.tableName&&(i=vt({},r,{},{cf_xdr_shxym:a.idShxym,cf_xdr_gszc:a.idGszc,cf_xdr_zzjg:a.idZzjg,cf_xdr_swdj:a.idSwdj,cf_xdr_sydw:a.idSydw,cf_xdr_shzz:a.idShzz}))),"nat"===t&&"leg_base_info"===this.tableName&&(i=vt({},r,{},{fddbr:e.name,fddbrzjlx:e.idType,fddbrzjhm:e.idCode})),this.$emit("on-select",i)}}};function kt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function _t(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?kt(a,!0).forEach((function(t){Ct(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):kt(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Ct(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Rt={components:{FormControl:xt,FormItem:ye},data:function(){return{dynamicForm:[],form:{},resetForm:{},rules:{},btnLoading:!1}},methods:{fieldsToInfoItem:function(e,t){if(e.fieldName.indexOf("person_id")>-1)return{directoryId:t,fieldName:e.fieldName,fieldTitle:e.fieldTitle,dataType:e.dataType,dataLength:e.dataLength,dataPrecision:e.dataPrecision,openType:"PUBLIC",controlType:"",fieldDesc:"",validValue:"",maskModel:"",isEncrypt:"",required:"",status:"use",tokenizer:"",checkRules:"[]"};var a={string:"TEXT",number:"NUMBER_TEXT",date:"DATE",datetime:"DATE_TIME",text:"TEXTAREA"},n={string:"string",number:"number",date:"string",datetime:"string",text:"string"}[e.dataType],r={string:"blur",number:"change",date:"change",datetime:"change",text:"blur"}[e.dataType],i='[{"name":"$required","message":"'.concat(e.fieldTitle,'必填","type":"').concat(n,'","trigger":"').concat(r,'"}]');return{directoryId:t,fieldName:e.fieldName,fieldTitle:e.fieldTitle,dataType:e.dataType,dataLength:e.dataLength,dataPrecision:e.dataPrecision,openType:"PUBLIC",controlType:a[e.dataType],fieldDesc:"",validValue:"",maskModel:"",isEncrypt:e.isEncrypt?e.isEncrypt:"",required:"Y",status:"use",tokenizer:"",checkRules:i}},handleSelectNatLeg:function(e){var t=this;Object.keys(e).forEach((function(a){t.form.hasOwnProperty(a)&&(t.form[a]=e[a],-1===a.indexOf("person_id")&&t.$refs.dynamicFormRef.validateField(a))}))},handleDynamicFormSubmit:function(){var e=this;console.log(this.form),this.$refs.dynamicFormRef.validate((function(t){t?(e.$message({type:"success",content:"表单校验成功"}),e.$log.primary("表单校验成功")):(e.$message({type:"danger",content:"表单校验失败"}),e.$log.danger("表单校验失败"))}))},handleDynamicFormReset:function(){this.$refs.dynamicFormRef&&this.$refs.dynamicFormRef.resetFields()},initDynamicForm:function(e){var t=this;this.form={},this.rules={},this.$set(this.form,"id",""),"nat_base_info"!==this.resource.tableName&&this.$set(this.form,"person_id",""),e.forEach((function(e){if(t.$set(t.form,e.fieldName.toLowerCase(),"number"===e.dataType?null:""),0===e.fieldName.indexOf("id_name")){var a=e.fieldName.slice(7);t.$set(t.form,"person_id".concat(a),"")}var n=B(e.checkRules,t.form);n.length>0&&t.$set(t.rules,e.fieldName,n)})),this.$log.primary("----form----"),console.log(this.form),this.$log.success("----rules----"),console.log(this.rules),this.resetForm=Object(l["a"])(this.form),this.handleDynamicFormReset()},decodeAndMaskFormat:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=[];return e.forEach((function(e){var r=_t({},e);t.dynamicForm.forEach((function(t){"1"===t.isEncrypt&&(r[t.fieldName]=Ve(e[t.fieldName])),a&&Object(gt["a"])(t.maskModel,["ID_CODE","MOBILE_PHONE"])&&(r[t.fieldName]=je(r[t.fieldName],t.maskModel))})),n.push(r)})),n},decodeFormObj:function(e){var t=_t({},e);return this.dynamicForm.forEach((function(a){"1"===a.isEncrypt&&(t[a.fieldName]=Ve(e[a.fieldName]))})),t},getEncodeFormObj:function(){var e=this,t=_t({},this.form);return this.dynamicForm.forEach((function(a){"1"===a.isEncrypt&&(t[a.fieldName]=ze(e.form[a.fieldName]))})),t},setFormObj:function(e){var t=this;Object.keys(this.form).forEach((function(a){e.hasOwnProperty(a)&&(t.form[a]=e[a])}))}}},wt={name:"FormDemo",mixins:[Rt],components:{FormControl:xt,FormItem:ye,FieldsCfg:ge},data:function(){return{resource:{tableName:"test_table_name"},debugJson:!0,jsonModal:!1,previewModal:!1,previewModalForm:!1,jsonStr:"",fields:[]}},methods:{getMetadata:function(){var e=this;return be.map((function(t){return e.fieldsToInfoItem(t,"directoryId")}))},openJsonModal:function(){this.jsonStr=JSON.stringify(this.getMetadata(),null,2),this.jsonModal=!0},importJson:function(){try{this.fields=JSON.parse(this.jsonStr)}catch(e){this.$message({type:"danger",content:"输入格式不合法"})}},loadFields:function(){this.fields=ve},previewForm:function(){var e=this;if(0!==this.fields.length){var t=this.fields.filter((function(e){return-1===e.fieldName.indexOf("_id")&&"use"===e.status}));z(t).then((function(t){e.previewModal=!0,e.previewModalForm=!0,e.handleDynamicFormReset(),e.dynamicForm=t,e.initDynamicForm(t)}))}else this.$message({type:"danger",content:"没有配置信息项，请配置后预览"})}}},Dt=wt,Tt=Object(g["a"])(Dt,n,r,!1,null,null,null);t["default"]=Tt.exports},"3bf2":function(e,t,a){},"4cc1":function(e,t,a){},6191:function(e){e.exports=JSON.parse('{"dataType":{"string":"字符型","number":"数值型","date":"日期型","datetime":"日期时间型","text":"备注型"},"required":{"Y":"核心项","G":"一般项","A":"辅助项"},"controlType":{"TEXT":"文本框","NUMBER_TEXT":"数值文本框","SELECT":"下拉框","MULTIPLE_SELECT":"多选下拉框","DATE":"日期","DATE_TIME":"日期时间","TEXTAREA":"文本域","NAT_PERSON":"选择自然人","LEG_PERSON":"选择法人","NAT_OR_LEG_PERSON":"选择自然人或法人","FILE_UPLOAD":"文件上传"},"openType":{"PUBLIC":"社会公开","DEPART_RANGE":"授权访问","PRIVATE":"不公开"},"maskModel":{"ID_CODE":"身份证","MOBILE_PHONE":"手机号"},"isEncrypt":{"0":"否","1":"是"},"status":{"use":"选用","ignore":"不选用"},"tokenizer":{"N":"否","Y":"是"}}')},6409:function(e,t,a){"use strict";var n=a("9c63"),r=a.n(n);r.a},8811:function(e,t,a){"use strict";var n=a("989b"),r=a.n(n);r.a},9028:function(e,t,a){"use strict";var n=a("c125"),r=a.n(n);r.a},"989b":function(e,t,a){},"9b54":function(e,t,a){"use strict";var n=a("4cc1"),r=a.n(n);r.a},"9c63":function(e,t,a){},c125:function(e,t,a){},c66e:function(e){e.exports=JSON.parse('[{"id":"c0a86e9370f018e08170f0eaefc90021","directoryId":"c0a86e9370f018e08170f0eaefc50017","fieldName":"name","fieldTitle":"姓名","fieldDesc":"","dataType":"string","required":"Y","validValue":"","checkRules":"[{\\"name\\":\\"$required\\",\\"message\\":\\"姓名必填\\",\\"type\\":\\"string\\",\\"trigger\\":\\"blur\\"}]","params":null,"controlType":"TEXT","maskModel":"","openType":"PUBLIC","isEncrypt":"","fieldSort":0,"status":"use","dataLength":64,"tokenizer":"N"},{"id":"c0a86e9370f018e08170f0eaefc8001d","directoryId":"c0a86e9370f018e08170f0eaefc50017","fieldName":"id_type","fieldTitle":"证件类型","fieldDesc":"","dataType":"string","required":"Y","validValue":"自然人证件类型/natIdType","checkRules":"[{\\"name\\":\\"$required\\",\\"message\\":\\"证件类型必填\\",\\"type\\":\\"string\\",\\"trigger\\":\\"change\\"}]","params":null,"controlType":"SELECT","maskModel":"","openType":"PUBLIC","isEncrypt":"","fieldSort":1,"dataLength":3,"status":"use","tokenizer":"N"},{"id":"c0a86e9370f018e08170f0eaefc80020","directoryId":"c0a86e9370f018e08170f0eaefc50017","fieldName":"id_code","fieldTitle":"证件号码","fieldDesc":"","dataType":"string","required":"Y","validValue":"","checkRules":"[{\\"name\\":\\"$required\\",\\"message\\":\\"证件号码必填\\",\\"type\\":\\"string\\",\\"trigger\\":\\"blur\\"}]","params":null,"controlType":"TEXT","maskModel":"ID_CODE","openType":"PUBLIC","isEncrypt":"1","fieldSort":2,"dataLength":64,"status":"use","tokenizer":"N"},{"id":"c0a86e9370f018e08170f0eaefc7001b","directoryId":"c0a86e9370f018e08170f0eaefc50017","fieldName":"bz","fieldTitle":"备注","fieldDesc":"","dataType":"text","required":"G","validValue":"","dataLength":200,"checkRules":"[]","params":null,"controlType":"TEXTAREA","openType":"PUBLIC","fieldSort":9,"status":"use","tokenizer":""},{"id":"c0a86e9370f018e08170f0eaefc60018","directoryId":"c0a86e9370f018e08170f0eaefc50017","fieldName":"ceshi1","fieldTitle":"测试1","fieldDesc":"测试1","dataType":"number","required":"Y","validValue":"","checkRules":"[{\\"name\\":\\"$required\\",\\"message\\":\\"测试1必填\\",\\"type\\":\\"number\\",\\"trigger\\":\\"change\\"}]","params":null,"controlType":"NUMBER_TEXT","maskModel":"","openType":"PUBLIC","isEncrypt":"","fieldSort":10,"dataLength":64,"status":"use","tokenizer":"N"},{"id":"c0a86e9370f018e08170f0eaefc7001c","directoryId":"c0a86e9370f018e08170f0eaefc50017","fieldName":"ceshi2","fieldTitle":"测试2","fieldDesc":"测试2","dataType":"string","required":"Y","validValue":"","checkRules":"[{\\"name\\":\\"$required\\",\\"message\\":\\"测试2必填\\",\\"type\\":\\"string\\",\\"trigger\\":\\"blur\\"}]","params":null,"controlType":"TEXT","maskModel":"","openType":"PUBLIC","isEncrypt":"","fieldSort":11,"status":"use","tokenizer":"","dataLength":64}]')},ea4a:function(e,t,a){"use strict";var n=a("3bf2"),r=a.n(n);r.a}}]);